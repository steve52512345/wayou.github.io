<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>试用 Deno | 牛さんの部落格</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="试用 Deno" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="试用 Deno 图片来自 deno twitter Deno 1.0 正式版释出，趁着余温尝试一波。 安装 文档 中给出了多种安装姿势，mac 上 brew 当然是不二之选，简单高效。 $ brew install deno 运行 Demo 安装成功后就可以跑 Demo 了。Deno 中运行代码也是非常方便，因为天然支持从远端拉取。 $ deno run https://deno.land/std/examples/welcome.ts Compile https://deno.land/std/examples/welcome.ts Welcome to Deno 🦕 Hello World 程序正常打印出了信息， so far so good! 接着运行官网提供的另一示例，问题来了。 创建 index.ts 文件并写入以下代码： import { serve } from &quot;https://deno.land/std@0.50.0/http/server.ts&quot;; const s = serve({ port: 8000 }); console.log(&quot;http://localhost:8000/&quot;); for await (const req of s) { req.respond({ body: &quot;Hello World\n&quot; }); } 引入 server 标准库起一个本地服务器，没什么可说的，让我们跑起来： $ deno index.ts 以下是运行上面的示例代码后的错误输出： 使用 deno 启动本地服务的报错信息 ```sh deno run --allow-net ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts error TS2322: Type &#39;(_: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:10:5 10 read(_: Uint8Array): Promise&lt;number | null&gt; { ~~~~ error TS2322: Type &#39;(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:35:12 35 return { read }; ~~~~ error TS2322: Type &#39;(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:113:12 113 return { read }; ~~~~ error TS2339: Property &#39;iter&#39; does not exist on type &#39;typeof Deno&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:167:34 167 for await (const chunk of Deno.iter(r)) { ~~~~ error TS2345: Argument of type &#39;Reader&#39; is not assignable to parameter of type &#39;Writer&#39;. Property &#39;write&#39; is missing in type &#39;Reader&#39; but required in type &#39;Writer&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:265:31 265 const n = await Deno.copy(r.body, writer); ~~~~~~ &#39;write&#39; is declared here. ► $asset$/lib.deno.ns.d.ts:366:5 366 write(p: Uint8Array): Promise; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2339: Property &#39;listenTls&#39; does not exist on type &#39;typeof Deno&#39;. ► https://deno.land/std@0.50.0/http/server.ts:16:17 16 const { listen, listenTls } = Deno; ~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;ListenTlsOptions&#39;. ► https://deno.land/std@0.50.0/http/server.ts:289:38 289 export type HTTPSOptions = Omit&lt;Deno.ListenTlsOptions, &quot;transport&quot;&gt;; ~~~~~~~~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;ListenTlsOptions&#39;. ► https://deno.land/std@0.50.0/http/server.ts:309:26 309 const tlsOptions: Deno.ListenTlsOptions = { ~~~~~~~~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;WriterSync&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:8:24 8 type WriterSync = Deno.WriterSync; ~~~~~~~~~~ error TS2469: The &#39;&gt;=&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:90:14 90 assert(rr &gt;= 0, &quot;negative read&quot;); ~~ error TS2365: Operator &#39;+=&#39; cannot be applied to types &#39;number&#39; and &#39;number | unique symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:91:7 91 this.w += rr; ~~~~~~~~~~~~ error TS2469: The &#39;&gt;&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:92:11 92 if (rr &gt; 0) { ~~ error TS2416: Property &#39;read&#39; in type &#39;BufReader&#39; is not assignable to the same property in base type &#39;Reader&#39;. Type &#39;(p: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. Type &#39;number | null&#39; is not assignable to type &#39;number | unique symbol&#39;. Type &#39;null&#39; is not assignable to type &#39;number | unique symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:123:9 123 async read(p: Uint8Array): Promise&lt;number | null&gt; { ~~~~ error TS2469: The &#39;&gt;=&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:133:16 133 assert(nread &gt;= 0, &quot;negative read&quot;); ~~~~~ error TS2322: Type &#39;number | unique symbol&#39; is not assignable to type &#39;number | null&#39;. Type &#39;unique symbol&#39; is not assignable to type &#39;number | null&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:138:9 138 return rr; ~~~~~~~~~~ error TS2322: Type &#39;number | unique symbol&#39; is not assignable to type &#39;number | null&#39;. Type &#39;unique symbol&#39; is not assignable to type &#39;number | null&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:145:7 145 rr = await this.rd.read(this.buf); ~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/_constants.ts:51:19 51 const isWindows = build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/_globrex.ts:5:15 5 const isWin = Deno.build.os === &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/mod.ts:7:19 7 const isWindows = Deno.build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2345: Argument of type &#39;string | URL&#39; is not assignable to parameter of type &#39;string&#39;. Type &#39;URL&#39; is not assignable to type &#39;string&#39;. ► https://deno.land/std@0.50.0/path/posix.ts:433:18 433 return new URL(url).pathname; ~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/separator.ts:2:19 2 const isWindows = Deno.build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2339: Property &#39;get&#39; does not exist on type &#39;{ (): { [index: string]: string; }; (key: string): string | undefined; }&#39;. ► https://deno.land/std@0.50.0/path/win32.ts:42:18 42 path = env.get(`=${resolvedDevice}`) || cwd(); ~~~ error TS2345: Argument of type &#39;string | URL&#39; is not assignable to parameter of type &#39;string&#39;. Type &#39;URL&#39; is not assignable to type &#39;string&#39;. ► https://deno.land/std@0.50.0/path/win32.ts:911:18 911 return new URL(url).pathname ~~~ Found 23 errors. ``` &lt;/details&gt; 这么多报错，肯定姿势不对。细查后发现了问题，安装的 deno 版本并不是刚发布还热乎的 1.0！ ```sh $ deno -V deno 0.36.0 ``` 再去看 brew 上面的版本，果然： ```sh $ brew info deno deno: stable 0.36.0 (bottled) Command-line JavaScript / TypeScript engine https://deno.land/ /usr/local/Cellar/deno/0.36.0 (9 files, 55.1MB) * Poured from bottle on 2020-05-17 at 14:31:34 From: https://mirrors.ustc.edu.cn/homebrew-core.git/Formula/deno.rb ==&gt; Dependencies Build: ninja ✔, rust ✘ ==&gt; Requirements Build: xcode ✔ ==&gt; Caveats Bash completion has been installed to: /usr/local/etc/bash_completion.d zsh completions have been installed to: /usr/local/share/zsh/site-functions ==&gt; Analytics install: 13,653 (30 days), 20,861 (90 days), 37,002 (365 days) install-on-request: 13,649 (30 days), 20,843 (90 days), 36,969 (365 days) build-error: 0 (30 days) ``` 之前一直有个习惯，安装完某个东西后会查看版本，以检查安装是否成功，顺便确定所装版本。这次栽了。 ### 重新安装 使用 brew 安装前先 `brew update` 或不使用 brew，通过以下命令来安装： ```sh $ curl -fsSL https://deno.land/x/install/install.sh | sh ``` 通过 curl 安装 deno 过程中的输出 ```sh curl -fsSL https://deno.land/x/install/install.sh | sh ######################################################################## 100.0% Archive: /Users/wayou/.deno/bin/deno.zip inflating: deno Deno was installed successfully to /Users/wayou/.deno/bin/deno Manually add the directory to your $HOME/.bash_profile (or similar) export DENO_INSTALL=&quot;/Users/wayou/.deno&quot; export PATH=&quot;$DENO_INSTALL/bin:$PATH&quot; Run &#39;/Users/wayou/.deno/bin/deno --help&#39; to get started ``` ### 添加环境变量 如果使用 brew 安装可省略此步骤。 根据提示，需要将 deno 添加到环境变量中方可在命令行中执行： ```sh export DENO_INSTALL=&quot;/Users/wayou/.deno&quot; export PATH=&quot;$DENO_INSTALL/bin:$PATH&quot; ``` ### 再次运行 检查安装： ```sh $ deno -V deno 1.0.0 ``` 现在对了，再次运行前面失败的示例： ```sh $ deno run ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts error: Uncaught PermissionDenied: network access to &quot;0.0.0.0:8000&quot;, run again with the --allow-net flag at unwrapResponse ($deno$/ops/dispatch_json.ts:43:11) at Object.sendSync ($deno$/ops/dispatch_json.ts:72:10) at Object.listen ($deno$/ops/net.ts:51:10) at listen ($deno$/net.ts:152:22) at serve (https://deno.land/std@0.50.0/http/server.ts:261:20) at file:///Users/wayou/work/dev/github/deno-demo/index.ts:2:11 ``` 还是报错，但错误不一样了。 ### 权限问题 Deno 中对权限的要求更加细致，这里的命令需要给到网络权限。修正我们的命令再次运行： ```sh $ deno run --allow-net ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts http://localhost:8000/ ``` 访问 [http://localhost:8000/](http://localhost:8000/)，Demo 达成。 访问 Deno 启动的服务 ## What&#39;s next? ### 命令的自动补全 查看 deno 的帮助，发现其提供了各 shell 下的补全脚本， ```sh $ deno -h ... completions Generate shell completions ... ``` 这就好玩了，对于 fish shell，其补全脚本为： fish shell 的 deno 补全脚本 ```sh $ deno completions fish complete -c deno -n &quot;__fish_use_subcommand&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_use_subcommand&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;bundle&quot; -d &#39;Bundle module and dependencies into single file&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;completions&quot; -d &#39;Generate shell completions&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;eval&quot; -d &#39;Eval script&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;cache&quot; -d &#39;Cache the dependencies&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;fmt&quot; -d &#39;Format source files&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;info&quot; -d &#39;Show info about cache or info related to source file&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;install&quot; -d &#39;Install script as an executable&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;repl&quot; -d &#39;Read Eval Print Loop&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;run&quot; -d &#39;Run a program given a filename or url to the module&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;test&quot; -d &#39;Run tests&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;types&quot; -d &#39;Print runtime TypeScript declarations&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;upgrade&quot; -d &#39;Upgrade deno executable to given version&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;doc&quot; -d &#39;Show documentation for a module&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;help&quot; -d &#39;Prints this message or the help of the given subcommand(s)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s T -l ts -d &#39;Treat eval input as TypeScript&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -l check -d &#39;Check if the source files are formatted.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s n -l name -d &#39;Executable file name&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l root -d &#39;Installation root&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s f -l force -d &#39;Forcefully overwrite existing installation&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l seed -d &#39;Seed Math.random()&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l cached-only -d &#39;Require that remote dependencies are already cached&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l seed -d &#39;Seed Math.random()&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l filter -d &#39;A pattern to filter the tests to run by&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l cached-only -d &#39;Require that remote dependencies are already cached&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l failfast -d &#39;Stop on first error&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-none -d &#39;Don\&#39;t return error code if no test files are found&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -l version -d &#39;The version to upgrade to&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -l dry-run -d &#39;Perform all checks without replacing old exe&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s f -l force -d &#39;Replace current exe even if not out-of-date&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -l json -d &#39;Output documentation in JSON format.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; ``` 将其制作成 fish 插件安装后，就可以通过 Tab 看到自动的命令提示了： ```sh $ omf install https://github.com/wayou/plugin-deno ``` 上面只是一点微小的工作，接下来，就是广大社区的拥趸们，开启又一轮造轮子狂欢热潮时候了。 其实一些轮子已经在路上了，[从 Node.js 移民 deno 指南](https://dev.to/aralroca/from-node-to-deno-5gpn#express--koa)。 从 Deno 证实了一些事情： - TypeScript 大势所趋，不管喜欢与否。其实早在 2014 年 Angular2 就将这个趋势奠定了，实力诠释了一波无敌是多么的寂寞。 - 解决了 Ryan Dahl 在 [10 Things I Regret About Node.js ](https://medium.com/@imior/10-things-i-regret-about-node-js-ryan-dahl-2ba71ff6b4dc) 演讲中提到的 10 个问题。根据 bug 守恒，问题不会减少，它只是换了种形式。 ## 相关资源 - [Deno 1.0](https://deno.land/v1)" />
<meta property="og:description" content="试用 Deno 图片来自 deno twitter Deno 1.0 正式版释出，趁着余温尝试一波。 安装 文档 中给出了多种安装姿势，mac 上 brew 当然是不二之选，简单高效。 $ brew install deno 运行 Demo 安装成功后就可以跑 Demo 了。Deno 中运行代码也是非常方便，因为天然支持从远端拉取。 $ deno run https://deno.land/std/examples/welcome.ts Compile https://deno.land/std/examples/welcome.ts Welcome to Deno 🦕 Hello World 程序正常打印出了信息， so far so good! 接着运行官网提供的另一示例，问题来了。 创建 index.ts 文件并写入以下代码： import { serve } from &quot;https://deno.land/std@0.50.0/http/server.ts&quot;; const s = serve({ port: 8000 }); console.log(&quot;http://localhost:8000/&quot;); for await (const req of s) { req.respond({ body: &quot;Hello World\n&quot; }); } 引入 server 标准库起一个本地服务器，没什么可说的，让我们跑起来： $ deno index.ts 以下是运行上面的示例代码后的错误输出： 使用 deno 启动本地服务的报错信息 ```sh deno run --allow-net ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts error TS2322: Type &#39;(_: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:10:5 10 read(_: Uint8Array): Promise&lt;number | null&gt; { ~~~~ error TS2322: Type &#39;(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:35:12 35 return { read }; ~~~~ error TS2322: Type &#39;(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:113:12 113 return { read }; ~~~~ error TS2339: Property &#39;iter&#39; does not exist on type &#39;typeof Deno&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:167:34 167 for await (const chunk of Deno.iter(r)) { ~~~~ error TS2345: Argument of type &#39;Reader&#39; is not assignable to parameter of type &#39;Writer&#39;. Property &#39;write&#39; is missing in type &#39;Reader&#39; but required in type &#39;Writer&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:265:31 265 const n = await Deno.copy(r.body, writer); ~~~~~~ &#39;write&#39; is declared here. ► $asset$/lib.deno.ns.d.ts:366:5 366 write(p: Uint8Array): Promise; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2339: Property &#39;listenTls&#39; does not exist on type &#39;typeof Deno&#39;. ► https://deno.land/std@0.50.0/http/server.ts:16:17 16 const { listen, listenTls } = Deno; ~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;ListenTlsOptions&#39;. ► https://deno.land/std@0.50.0/http/server.ts:289:38 289 export type HTTPSOptions = Omit&lt;Deno.ListenTlsOptions, &quot;transport&quot;&gt;; ~~~~~~~~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;ListenTlsOptions&#39;. ► https://deno.land/std@0.50.0/http/server.ts:309:26 309 const tlsOptions: Deno.ListenTlsOptions = { ~~~~~~~~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;WriterSync&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:8:24 8 type WriterSync = Deno.WriterSync; ~~~~~~~~~~ error TS2469: The &#39;&gt;=&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:90:14 90 assert(rr &gt;= 0, &quot;negative read&quot;); ~~ error TS2365: Operator &#39;+=&#39; cannot be applied to types &#39;number&#39; and &#39;number | unique symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:91:7 91 this.w += rr; ~~~~~~~~~~~~ error TS2469: The &#39;&gt;&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:92:11 92 if (rr &gt; 0) { ~~ error TS2416: Property &#39;read&#39; in type &#39;BufReader&#39; is not assignable to the same property in base type &#39;Reader&#39;. Type &#39;(p: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. Type &#39;number | null&#39; is not assignable to type &#39;number | unique symbol&#39;. Type &#39;null&#39; is not assignable to type &#39;number | unique symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:123:9 123 async read(p: Uint8Array): Promise&lt;number | null&gt; { ~~~~ error TS2469: The &#39;&gt;=&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:133:16 133 assert(nread &gt;= 0, &quot;negative read&quot;); ~~~~~ error TS2322: Type &#39;number | unique symbol&#39; is not assignable to type &#39;number | null&#39;. Type &#39;unique symbol&#39; is not assignable to type &#39;number | null&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:138:9 138 return rr; ~~~~~~~~~~ error TS2322: Type &#39;number | unique symbol&#39; is not assignable to type &#39;number | null&#39;. Type &#39;unique symbol&#39; is not assignable to type &#39;number | null&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:145:7 145 rr = await this.rd.read(this.buf); ~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/_constants.ts:51:19 51 const isWindows = build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/_globrex.ts:5:15 5 const isWin = Deno.build.os === &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/mod.ts:7:19 7 const isWindows = Deno.build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2345: Argument of type &#39;string | URL&#39; is not assignable to parameter of type &#39;string&#39;. Type &#39;URL&#39; is not assignable to type &#39;string&#39;. ► https://deno.land/std@0.50.0/path/posix.ts:433:18 433 return new URL(url).pathname; ~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/separator.ts:2:19 2 const isWindows = Deno.build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2339: Property &#39;get&#39; does not exist on type &#39;{ (): { [index: string]: string; }; (key: string): string | undefined; }&#39;. ► https://deno.land/std@0.50.0/path/win32.ts:42:18 42 path = env.get(`=${resolvedDevice}`) || cwd(); ~~~ error TS2345: Argument of type &#39;string | URL&#39; is not assignable to parameter of type &#39;string&#39;. Type &#39;URL&#39; is not assignable to type &#39;string&#39;. ► https://deno.land/std@0.50.0/path/win32.ts:911:18 911 return new URL(url).pathname ~~~ Found 23 errors. ``` &lt;/details&gt; 这么多报错，肯定姿势不对。细查后发现了问题，安装的 deno 版本并不是刚发布还热乎的 1.0！ ```sh $ deno -V deno 0.36.0 ``` 再去看 brew 上面的版本，果然： ```sh $ brew info deno deno: stable 0.36.0 (bottled) Command-line JavaScript / TypeScript engine https://deno.land/ /usr/local/Cellar/deno/0.36.0 (9 files, 55.1MB) * Poured from bottle on 2020-05-17 at 14:31:34 From: https://mirrors.ustc.edu.cn/homebrew-core.git/Formula/deno.rb ==&gt; Dependencies Build: ninja ✔, rust ✘ ==&gt; Requirements Build: xcode ✔ ==&gt; Caveats Bash completion has been installed to: /usr/local/etc/bash_completion.d zsh completions have been installed to: /usr/local/share/zsh/site-functions ==&gt; Analytics install: 13,653 (30 days), 20,861 (90 days), 37,002 (365 days) install-on-request: 13,649 (30 days), 20,843 (90 days), 36,969 (365 days) build-error: 0 (30 days) ``` 之前一直有个习惯，安装完某个东西后会查看版本，以检查安装是否成功，顺便确定所装版本。这次栽了。 ### 重新安装 使用 brew 安装前先 `brew update` 或不使用 brew，通过以下命令来安装： ```sh $ curl -fsSL https://deno.land/x/install/install.sh | sh ``` 通过 curl 安装 deno 过程中的输出 ```sh curl -fsSL https://deno.land/x/install/install.sh | sh ######################################################################## 100.0% Archive: /Users/wayou/.deno/bin/deno.zip inflating: deno Deno was installed successfully to /Users/wayou/.deno/bin/deno Manually add the directory to your $HOME/.bash_profile (or similar) export DENO_INSTALL=&quot;/Users/wayou/.deno&quot; export PATH=&quot;$DENO_INSTALL/bin:$PATH&quot; Run &#39;/Users/wayou/.deno/bin/deno --help&#39; to get started ``` ### 添加环境变量 如果使用 brew 安装可省略此步骤。 根据提示，需要将 deno 添加到环境变量中方可在命令行中执行： ```sh export DENO_INSTALL=&quot;/Users/wayou/.deno&quot; export PATH=&quot;$DENO_INSTALL/bin:$PATH&quot; ``` ### 再次运行 检查安装： ```sh $ deno -V deno 1.0.0 ``` 现在对了，再次运行前面失败的示例： ```sh $ deno run ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts error: Uncaught PermissionDenied: network access to &quot;0.0.0.0:8000&quot;, run again with the --allow-net flag at unwrapResponse ($deno$/ops/dispatch_json.ts:43:11) at Object.sendSync ($deno$/ops/dispatch_json.ts:72:10) at Object.listen ($deno$/ops/net.ts:51:10) at listen ($deno$/net.ts:152:22) at serve (https://deno.land/std@0.50.0/http/server.ts:261:20) at file:///Users/wayou/work/dev/github/deno-demo/index.ts:2:11 ``` 还是报错，但错误不一样了。 ### 权限问题 Deno 中对权限的要求更加细致，这里的命令需要给到网络权限。修正我们的命令再次运行： ```sh $ deno run --allow-net ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts http://localhost:8000/ ``` 访问 [http://localhost:8000/](http://localhost:8000/)，Demo 达成。 访问 Deno 启动的服务 ## What&#39;s next? ### 命令的自动补全 查看 deno 的帮助，发现其提供了各 shell 下的补全脚本， ```sh $ deno -h ... completions Generate shell completions ... ``` 这就好玩了，对于 fish shell，其补全脚本为： fish shell 的 deno 补全脚本 ```sh $ deno completions fish complete -c deno -n &quot;__fish_use_subcommand&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_use_subcommand&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;bundle&quot; -d &#39;Bundle module and dependencies into single file&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;completions&quot; -d &#39;Generate shell completions&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;eval&quot; -d &#39;Eval script&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;cache&quot; -d &#39;Cache the dependencies&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;fmt&quot; -d &#39;Format source files&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;info&quot; -d &#39;Show info about cache or info related to source file&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;install&quot; -d &#39;Install script as an executable&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;repl&quot; -d &#39;Read Eval Print Loop&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;run&quot; -d &#39;Run a program given a filename or url to the module&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;test&quot; -d &#39;Run tests&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;types&quot; -d &#39;Print runtime TypeScript declarations&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;upgrade&quot; -d &#39;Upgrade deno executable to given version&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;doc&quot; -d &#39;Show documentation for a module&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;help&quot; -d &#39;Prints this message or the help of the given subcommand(s)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s T -l ts -d &#39;Treat eval input as TypeScript&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -l check -d &#39;Check if the source files are formatted.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s n -l name -d &#39;Executable file name&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l root -d &#39;Installation root&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s f -l force -d &#39;Forcefully overwrite existing installation&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l seed -d &#39;Seed Math.random()&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l cached-only -d &#39;Require that remote dependencies are already cached&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l seed -d &#39;Seed Math.random()&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l filter -d &#39;A pattern to filter the tests to run by&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l cached-only -d &#39;Require that remote dependencies are already cached&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l failfast -d &#39;Stop on first error&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-none -d &#39;Don\&#39;t return error code if no test files are found&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -l version -d &#39;The version to upgrade to&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -l dry-run -d &#39;Perform all checks without replacing old exe&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s f -l force -d &#39;Replace current exe even if not out-of-date&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -l json -d &#39;Output documentation in JSON format.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; ``` 将其制作成 fish 插件安装后，就可以通过 Tab 看到自动的命令提示了： ```sh $ omf install https://github.com/wayou/plugin-deno ``` 上面只是一点微小的工作，接下来，就是广大社区的拥趸们，开启又一轮造轮子狂欢热潮时候了。 其实一些轮子已经在路上了，[从 Node.js 移民 deno 指南](https://dev.to/aralroca/from-node-to-deno-5gpn#express--koa)。 从 Deno 证实了一些事情： - TypeScript 大势所趋，不管喜欢与否。其实早在 2014 年 Angular2 就将这个趋势奠定了，实力诠释了一波无敌是多么的寂寞。 - 解决了 Ryan Dahl 在 [10 Things I Regret About Node.js ](https://medium.com/@imior/10-things-i-regret-about-node-js-ryan-dahl-2ba71ff6b4dc) 演讲中提到的 10 个问题。根据 bug 守恒，问题不会减少，它只是换了种形式。 ## 相关资源 - [Deno 1.0](https://deno.land/v1)" />
<link rel="canonical" href="http://localhost:4000/2020/05/17/%E8%AF%95%E7%94%A8-Deno.html" />
<meta property="og:url" content="http://localhost:4000/2020/05/17/%E8%AF%95%E7%94%A8-Deno.html" />
<meta property="og:site_name" content="牛さんの部落格" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-17T23:05:00+08:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/2020/05/17/%E8%AF%95%E7%94%A8-Deno.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/05/17/%E8%AF%95%E7%94%A8-Deno.html"},"description":"试用 Deno 图片来自 deno twitter Deno 1.0 正式版释出，趁着余温尝试一波。 安装 文档 中给出了多种安装姿势，mac 上 brew 当然是不二之选，简单高效。 $ brew install deno 运行 Demo 安装成功后就可以跑 Demo 了。Deno 中运行代码也是非常方便，因为天然支持从远端拉取。 $ deno run https://deno.land/std/examples/welcome.ts Compile https://deno.land/std/examples/welcome.ts Welcome to Deno 🦕 Hello World 程序正常打印出了信息， so far so good! 接着运行官网提供的另一示例，问题来了。 创建 index.ts 文件并写入以下代码： import { serve } from &quot;https://deno.land/std@0.50.0/http/server.ts&quot;; const s = serve({ port: 8000 }); console.log(&quot;http://localhost:8000/&quot;); for await (const req of s) { req.respond({ body: &quot;Hello World\\n&quot; }); } 引入 server 标准库起一个本地服务器，没什么可说的，让我们跑起来： $ deno index.ts 以下是运行上面的示例代码后的错误输出： 使用 deno 启动本地服务的报错信息 ```sh deno run --allow-net ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts error TS2322: Type &#39;(_: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:10:5 10 read(_: Uint8Array): Promise&lt;number | null&gt; { ~~~~ error TS2322: Type &#39;(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:35:12 35 return { read }; ~~~~ error TS2322: Type &#39;(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:113:12 113 return { read }; ~~~~ error TS2339: Property &#39;iter&#39; does not exist on type &#39;typeof Deno&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:167:34 167 for await (const chunk of Deno.iter(r)) { ~~~~ error TS2345: Argument of type &#39;Reader&#39; is not assignable to parameter of type &#39;Writer&#39;. Property &#39;write&#39; is missing in type &#39;Reader&#39; but required in type &#39;Writer&#39;. ► https://deno.land/std@0.50.0/http/_io.ts:265:31 265 const n = await Deno.copy(r.body, writer); ~~~~~~ &#39;write&#39; is declared here. ► $asset$/lib.deno.ns.d.ts:366:5 366 write(p: Uint8Array): Promise; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2339: Property &#39;listenTls&#39; does not exist on type &#39;typeof Deno&#39;. ► https://deno.land/std@0.50.0/http/server.ts:16:17 16 const { listen, listenTls } = Deno; ~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;ListenTlsOptions&#39;. ► https://deno.land/std@0.50.0/http/server.ts:289:38 289 export type HTTPSOptions = Omit&lt;Deno.ListenTlsOptions, &quot;transport&quot;&gt;; ~~~~~~~~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;ListenTlsOptions&#39;. ► https://deno.land/std@0.50.0/http/server.ts:309:26 309 const tlsOptions: Deno.ListenTlsOptions = { ~~~~~~~~~~~~~~~~ error TS2694: Namespace &#39;Deno&#39; has no exported member &#39;WriterSync&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:8:24 8 type WriterSync = Deno.WriterSync; ~~~~~~~~~~ error TS2469: The &#39;&gt;=&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:90:14 90 assert(rr &gt;= 0, &quot;negative read&quot;); ~~ error TS2365: Operator &#39;+=&#39; cannot be applied to types &#39;number&#39; and &#39;number | unique symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:91:7 91 this.w += rr; ~~~~~~~~~~~~ error TS2469: The &#39;&gt;&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:92:11 92 if (rr &gt; 0) { ~~ error TS2416: Property &#39;read&#39; in type &#39;BufReader&#39; is not assignable to the same property in base type &#39;Reader&#39;. Type &#39;(p: Uint8Array) =&gt; Promise&lt;number | null&gt;&#39; is not assignable to type &#39;(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;&#39;. Type &#39;Promise&lt;number | null&gt;&#39; is not assignable to type &#39;Promise&lt;number | unique symbol&gt;&#39;. Type &#39;number | null&#39; is not assignable to type &#39;number | unique symbol&#39;. Type &#39;null&#39; is not assignable to type &#39;number | unique symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:123:9 123 async read(p: Uint8Array): Promise&lt;number | null&gt; { ~~~~ error TS2469: The &#39;&gt;=&#39; operator cannot be applied to type &#39;symbol&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:133:16 133 assert(nread &gt;= 0, &quot;negative read&quot;); ~~~~~ error TS2322: Type &#39;number | unique symbol&#39; is not assignable to type &#39;number | null&#39;. Type &#39;unique symbol&#39; is not assignable to type &#39;number | null&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:138:9 138 return rr; ~~~~~~~~~~ error TS2322: Type &#39;number | unique symbol&#39; is not assignable to type &#39;number | null&#39;. Type &#39;unique symbol&#39; is not assignable to type &#39;number | null&#39;. ► https://deno.land/std@0.50.0/io/bufio.ts:145:7 145 rr = await this.rd.read(this.buf); ~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/_constants.ts:51:19 51 const isWindows = build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/_globrex.ts:5:15 5 const isWin = Deno.build.os === &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/mod.ts:7:19 7 const isWindows = Deno.build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2345: Argument of type &#39;string | URL&#39; is not assignable to parameter of type &#39;string&#39;. Type &#39;URL&#39; is not assignable to type &#39;string&#39;. ► https://deno.land/std@0.50.0/path/posix.ts:433:18 433 return new URL(url).pathname; ~~~ error TS2367: This condition will always return &#39;false&#39; since the types &#39;OperatingSystem&#39; and &#39;&quot;windows&quot;&#39; have no overlap. ► https://deno.land/std@0.50.0/path/separator.ts:2:19 2 const isWindows = Deno.build.os == &quot;windows&quot;; ~~~~~~~~~~~~~~~~~~~~~~~~~~ error TS2339: Property &#39;get&#39; does not exist on type &#39;{ (): { [index: string]: string; }; (key: string): string | undefined; }&#39;. ► https://deno.land/std@0.50.0/path/win32.ts:42:18 42 path = env.get(`=${resolvedDevice}`) || cwd(); ~~~ error TS2345: Argument of type &#39;string | URL&#39; is not assignable to parameter of type &#39;string&#39;. Type &#39;URL&#39; is not assignable to type &#39;string&#39;. ► https://deno.land/std@0.50.0/path/win32.ts:911:18 911 return new URL(url).pathname ~~~ Found 23 errors. ``` &lt;/details&gt; 这么多报错，肯定姿势不对。细查后发现了问题，安装的 deno 版本并不是刚发布还热乎的 1.0！ ```sh $ deno -V deno 0.36.0 ``` 再去看 brew 上面的版本，果然： ```sh $ brew info deno deno: stable 0.36.0 (bottled) Command-line JavaScript / TypeScript engine https://deno.land/ /usr/local/Cellar/deno/0.36.0 (9 files, 55.1MB) * Poured from bottle on 2020-05-17 at 14:31:34 From: https://mirrors.ustc.edu.cn/homebrew-core.git/Formula/deno.rb ==&gt; Dependencies Build: ninja ✔, rust ✘ ==&gt; Requirements Build: xcode ✔ ==&gt; Caveats Bash completion has been installed to: /usr/local/etc/bash_completion.d zsh completions have been installed to: /usr/local/share/zsh/site-functions ==&gt; Analytics install: 13,653 (30 days), 20,861 (90 days), 37,002 (365 days) install-on-request: 13,649 (30 days), 20,843 (90 days), 36,969 (365 days) build-error: 0 (30 days) ``` 之前一直有个习惯，安装完某个东西后会查看版本，以检查安装是否成功，顺便确定所装版本。这次栽了。 ### 重新安装 使用 brew 安装前先 `brew update` 或不使用 brew，通过以下命令来安装： ```sh $ curl -fsSL https://deno.land/x/install/install.sh | sh ``` 通过 curl 安装 deno 过程中的输出 ```sh curl -fsSL https://deno.land/x/install/install.sh | sh ######################################################################## 100.0% Archive: /Users/wayou/.deno/bin/deno.zip inflating: deno Deno was installed successfully to /Users/wayou/.deno/bin/deno Manually add the directory to your $HOME/.bash_profile (or similar) export DENO_INSTALL=&quot;/Users/wayou/.deno&quot; export PATH=&quot;$DENO_INSTALL/bin:$PATH&quot; Run &#39;/Users/wayou/.deno/bin/deno --help&#39; to get started ``` ### 添加环境变量 如果使用 brew 安装可省略此步骤。 根据提示，需要将 deno 添加到环境变量中方可在命令行中执行： ```sh export DENO_INSTALL=&quot;/Users/wayou/.deno&quot; export PATH=&quot;$DENO_INSTALL/bin:$PATH&quot; ``` ### 再次运行 检查安装： ```sh $ deno -V deno 1.0.0 ``` 现在对了，再次运行前面失败的示例： ```sh $ deno run ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts error: Uncaught PermissionDenied: network access to &quot;0.0.0.0:8000&quot;, run again with the --allow-net flag at unwrapResponse ($deno$/ops/dispatch_json.ts:43:11) at Object.sendSync ($deno$/ops/dispatch_json.ts:72:10) at Object.listen ($deno$/ops/net.ts:51:10) at listen ($deno$/net.ts:152:22) at serve (https://deno.land/std@0.50.0/http/server.ts:261:20) at file:///Users/wayou/work/dev/github/deno-demo/index.ts:2:11 ``` 还是报错，但错误不一样了。 ### 权限问题 Deno 中对权限的要求更加细致，这里的命令需要给到网络权限。修正我们的命令再次运行： ```sh $ deno run --allow-net ./index.ts Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts http://localhost:8000/ ``` 访问 [http://localhost:8000/](http://localhost:8000/)，Demo 达成。 访问 Deno 启动的服务 ## What&#39;s next? ### 命令的自动补全 查看 deno 的帮助，发现其提供了各 shell 下的补全脚本， ```sh $ deno -h ... completions Generate shell completions ... ``` 这就好玩了，对于 fish shell，其补全脚本为： fish shell 的 deno 补全脚本 ```sh $ deno completions fish complete -c deno -n &quot;__fish_use_subcommand&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_use_subcommand&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;bundle&quot; -d &#39;Bundle module and dependencies into single file&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;completions&quot; -d &#39;Generate shell completions&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;eval&quot; -d &#39;Eval script&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;cache&quot; -d &#39;Cache the dependencies&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;fmt&quot; -d &#39;Format source files&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;info&quot; -d &#39;Show info about cache or info related to source file&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;install&quot; -d &#39;Install script as an executable&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;repl&quot; -d &#39;Read Eval Print Loop&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;run&quot; -d &#39;Run a program given a filename or url to the module&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;test&quot; -d &#39;Run tests&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;types&quot; -d &#39;Print runtime TypeScript declarations&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;upgrade&quot; -d &#39;Upgrade deno executable to given version&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;doc&quot; -d &#39;Show documentation for a module&#39; complete -c deno -n &quot;__fish_use_subcommand&quot; -f -a &quot;help&quot; -d &#39;Prints this message or the help of the given subcommand(s)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from bundle&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from completions&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s T -l ts -d &#39;Treat eval input as TypeScript&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from eval&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from cache&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -l check -d &#39;Check if the source files are formatted.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from fmt&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from info&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s n -l name -d &#39;Executable file name&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l root -d &#39;Installation root&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s f -l force -d &#39;Forcefully overwrite existing installation&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from install&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from repl&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l seed -d &#39;Seed Math.random()&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -l cached-only -d &#39;Require that remote dependencies are already cached&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from run&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l inspect -d &#39;activate inspector on host:port (default: 127.0.0.1:9229)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l inspect-brk -d &#39;activate inspector on host:port and break at start of user script&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-read -d &#39;Allow file system read access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-write -d &#39;Allow file system write access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-net -d &#39;Allow network access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l importmap -d &#39;UNSTABLE: Load import map file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s c -l config -d &#39;Load tsconfig.json configuration file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l lock -d &#39;Check the specified lock file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l v8-flags -d &#39;Set V8 command line options. For help: --v8-flags=--help&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l cert -d &#39;Load certificate authority from PEM encoded file&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l seed -d &#39;Seed Math.random()&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l filter -d &#39;A pattern to filter the tests to run by&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-env -d &#39;Allow environment access&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-run -d &#39;Allow running subprocesses&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-plugin -d &#39;Allow loading plugins&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-hrtime -d &#39;Allow high resolution time measurement&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s A -l allow-all -d &#39;Allow all permissions&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l lock-write -d &#39;Write lock file. Use with --lock.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l no-remote -d &#39;Do not resolve remote modules&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l cached-only -d &#39;Require that remote dependencies are already cached&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l failfast -d &#39;Stop on first error&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -l allow-none -d &#39;Don\\&#39;t return error code if no test files are found&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from test&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from types&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -l version -d &#39;The version to upgrade to&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -l dry-run -d &#39;Perform all checks without replacing old exe&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s f -l force -d &#39;Replace current exe even if not out-of-date&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from upgrade&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s r -l reload -d &#39;Reload source code cache (recompile TypeScript)&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -l unstable -d &#39;Enable unstable APIs&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -l json -d &#39;Output documentation in JSON format.&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from doc&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s L -l log-level -d &#39;Set log level&#39; -r -f -a &quot;debug info&quot; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s h -l help -d &#39;Prints help information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s V -l version -d &#39;Prints version information&#39; complete -c deno -n &quot;__fish_seen_subcommand_from help&quot; -s q -l quiet -d &#39;Suppress diagnostic output&#39; ``` 将其制作成 fish 插件安装后，就可以通过 Tab 看到自动的命令提示了： ```sh $ omf install https://github.com/wayou/plugin-deno ``` 上面只是一点微小的工作，接下来，就是广大社区的拥趸们，开启又一轮造轮子狂欢热潮时候了。 其实一些轮子已经在路上了，[从 Node.js 移民 deno 指南](https://dev.to/aralroca/from-node-to-deno-5gpn#express--koa)。 从 Deno 证实了一些事情： - TypeScript 大势所趋，不管喜欢与否。其实早在 2014 年 Angular2 就将这个趋势奠定了，实力诠释了一波无敌是多么的寂寞。 - 解决了 Ryan Dahl 在 [10 Things I Regret About Node.js ](https://medium.com/@imior/10-things-i-regret-about-node-js-ryan-dahl-2ba71ff6b4dc) 演讲中提到的 10 个问题。根据 bug 守恒，问题不会减少，它只是换了种形式。 ## 相关资源 - [Deno 1.0](https://deno.land/v1)","@type":"BlogPosting","headline":"试用 Deno","dateModified":"2020-05-17T23:05:00+08:00","datePublished":"2020-05-17T23:05:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="牛さんの部落格" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">牛さんの部落格</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">试用 Deno</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-05-17T23:05:00+08:00" itemprop="datePublished">May 17, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="试用-deno">试用 Deno</h1>

<p><img width="100%" src="https://user-images.githubusercontent.com/3783096/82142751-25bb9c00-9871-11ea-9138-0d613936da3b.gif" /></p>
<p align="center">图片来自 deno twitter</p>

<p><a href="https://twitter.com/deno_land/status/1260701643311583234?s=20">Deno 1.0 正式版释出</a>，趁着余温尝试一波。</p>

<h2 id="安装">安装</h2>

<p><a href="https://github.com/denoland/deno_install">文档</a> 中给出了多种安装姿势，mac 上 brew 当然是不二之选，简单高效。</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew <span class="nb">install </span>deno
</code></pre></div></div>

<h2 id="运行-demo">运行 Demo</h2>

<p>安装成功后就可以跑 Demo 了。Deno 中运行代码也是非常方便，因为天然支持从远端拉取。</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>deno run https://deno.land/std/examples/welcome.ts
Compile https://deno.land/std/examples/welcome.ts
Welcome to Deno 🦕
</code></pre></div></div>

<p>Hello World 程序正常打印出了信息， so far so good!</p>

<p>接着运行官网提供的另一示例，问题来了。</p>

<p>创建 index.ts 文件并写入以下代码：</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">serve</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std@0.50.0/http/server.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">serve</span><span class="p">({</span> <span class="na">port</span><span class="p">:</span> <span class="mi">8000</span> <span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://localhost:8000/</span><span class="dl">"</span><span class="p">);</span>
<span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">req</span> <span class="k">of</span> <span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">req</span><span class="p">.</span><span class="nx">respond</span><span class="p">({</span> <span class="na">body</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Hello World</span><span class="se">\n</span><span class="dl">"</span> <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<p>引入 <code class="language-plaintext highlighter-rouge">server</code> 标准库起一个本地服务器，没什么可说的，让我们跑起来：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>deno index.ts
</code></pre></div></div>

<p>以下是运行上面的示例代码后的错误输出：</p>

<details>
<summary>
使用 deno 启动本地服务的报错信息
</summary>

```sh
deno run --allow-net ./index.ts
Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts
error TS2322: Type '(_: Uint8Array) =&gt; Promise&lt;number | null&gt;' is not assignable to type '(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;'.
  Type 'Promise&lt;number | null&gt;' is not assignable to type 'Promise&lt;number | unique symbol&gt;'.

► https://deno.land/std@0.50.0/http/_io.ts:10:5

10     read(_: Uint8Array): Promise&lt;number | null&gt; {
       ~~~~

error TS2322: Type '(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;' is not assignable to type '(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;'.
  Type 'Promise&lt;number | null&gt;' is not assignable to type 'Promise&lt;number | unique symbol&gt;'.

► https://deno.land/std@0.50.0/http/_io.ts:35:12

35   return { read };
              ~~~~

error TS2322: Type '(buf: Uint8Array) =&gt; Promise&lt;number | null&gt;' is not assignable to type '(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;'.
  Type 'Promise&lt;number | null&gt;' is not assignable to type 'Promise&lt;number | unique symbol&gt;'.

► https://deno.land/std@0.50.0/http/_io.ts:113:12

113   return { read };
               ~~~~

error TS2339: Property 'iter' does not exist on type 'typeof Deno'.

► https://deno.land/std@0.50.0/http/_io.ts:167:34

167   for await (const chunk of Deno.iter(r)) {
                                     ~~~~

error TS2345: Argument of type 'Reader' is not assignable to parameter of type 'Writer'.
  Property 'write' is missing in type 'Reader' but required in type 'Writer'.

► https://deno.land/std@0.50.0/http/_io.ts:265:31

265     const n = await Deno.copy(r.body, writer);
                                  ~~~~~~

  'write' is declared here.

    ► $asset$/lib.deno.ns.d.ts:366:5

    366     write(p: Uint8Array): Promise<number>;
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


error TS2339: Property 'listenTls' does not exist on type 'typeof Deno'.

► https://deno.land/std@0.50.0/http/server.ts:16:17

16 const { listen, listenTls } = Deno;
                   ~~~~~~~~~

error TS2694: Namespace 'Deno' has no exported member 'ListenTlsOptions'.

► https://deno.land/std@0.50.0/http/server.ts:289:38

289 export type HTTPSOptions = Omit&lt;Deno.ListenTlsOptions, "transport"&gt;;
                                         ~~~~~~~~~~~~~~~~

error TS2694: Namespace 'Deno' has no exported member 'ListenTlsOptions'.

► https://deno.land/std@0.50.0/http/server.ts:309:26

309   const tlsOptions: Deno.ListenTlsOptions = {
                             ~~~~~~~~~~~~~~~~

error TS2694: Namespace 'Deno' has no exported member 'WriterSync'.

► https://deno.land/std@0.50.0/io/bufio.ts:8:24

8 type WriterSync = Deno.WriterSync;
                         ~~~~~~~~~~

error TS2469: The '&gt;=' operator cannot be applied to type 'symbol'.

► https://deno.land/std@0.50.0/io/bufio.ts:90:14

90       assert(rr &gt;= 0, "negative read");
                ~~

error TS2365: Operator '+=' cannot be applied to types 'number' and 'number | unique symbol'.

► https://deno.land/std@0.50.0/io/bufio.ts:91:7

91       this.w += rr;
         ~~~~~~~~~~~~

error TS2469: The '&gt;' operator cannot be applied to type 'symbol'.

► https://deno.land/std@0.50.0/io/bufio.ts:92:11

92       if (rr &gt; 0) {
             ~~

error TS2416: Property 'read' in type 'BufReader' is not assignable to the same property in base type 'Reader'.
  Type '(p: Uint8Array) =&gt; Promise&lt;number | null&gt;' is not assignable to type '(p: Uint8Array) =&gt; Promise&lt;number | unique symbol&gt;'.
    Type 'Promise&lt;number | null&gt;' is not assignable to type 'Promise&lt;number | unique symbol&gt;'.
      Type 'number | null' is not assignable to type 'number | unique symbol'.
        Type 'null' is not assignable to type 'number | unique symbol'.

► https://deno.land/std@0.50.0/io/bufio.ts:123:9

123   async read(p: Uint8Array): Promise&lt;number | null&gt; {
            ~~~~

error TS2469: The '&gt;=' operator cannot be applied to type 'symbol'.

► https://deno.land/std@0.50.0/io/bufio.ts:133:16

133         assert(nread &gt;= 0, "negative read");
                   ~~~~~

error TS2322: Type 'number | unique symbol' is not assignable to type 'number | null'.
  Type 'unique symbol' is not assignable to type 'number | null'.

► https://deno.land/std@0.50.0/io/bufio.ts:138:9

138         return rr;
            ~~~~~~~~~~

error TS2322: Type 'number | unique symbol' is not assignable to type 'number | null'.
  Type 'unique symbol' is not assignable to type 'number | null'.

► https://deno.land/std@0.50.0/io/bufio.ts:145:7

145       rr = await this.rd.read(this.buf);
          ~~

error TS2367: This condition will always return 'false' since the types 'OperatingSystem' and '"windows"' have no overlap.

► https://deno.land/std@0.50.0/path/_constants.ts:51:19

51 const isWindows = build.os == "windows";
                     ~~~~~~~~~~~~~~~~~~~~~

error TS2367: This condition will always return 'false' since the types 'OperatingSystem' and '"windows"' have no overlap.

► https://deno.land/std@0.50.0/path/_globrex.ts:5:15

5 const isWin = Deno.build.os === "windows";
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~

error TS2367: This condition will always return 'false' since the types 'OperatingSystem' and '"windows"' have no overlap.

► https://deno.land/std@0.50.0/path/mod.ts:7:19

7 const isWindows = Deno.build.os == "windows";
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~

error TS2345: Argument of type 'string | URL' is not assignable to parameter of type 'string'.
  Type 'URL' is not assignable to type 'string'.

► https://deno.land/std@0.50.0/path/posix.ts:433:18

433   return new URL(url).pathname;
                     ~~~

error TS2367: This condition will always return 'false' since the types 'OperatingSystem' and '"windows"' have no overlap.

► https://deno.land/std@0.50.0/path/separator.ts:2:19

2 const isWindows = Deno.build.os == "windows";
                    ~~~~~~~~~~~~~~~~~~~~~~~~~~

error TS2339: Property 'get' does not exist on type '{ (): { [index: string]: string; }; (key: string): string | undefined; }'.

► https://deno.land/std@0.50.0/path/win32.ts:42:18

42       path = env.get(`=${resolvedDevice}`) || cwd();
                    ~~~

error TS2345: Argument of type 'string | URL' is not assignable to parameter of type 'string'.
  Type 'URL' is not assignable to type 'string'.

► https://deno.land/std@0.50.0/path/win32.ts:911:18

911   return new URL(url).pathname
                     ~~~


Found 23 errors.
```

&lt;/details&gt;

这么多报错，肯定姿势不对。细查后发现了问题，安装的 deno 版本并不是刚发布还热乎的 1.0！

```sh
$ deno -V
deno 0.36.0
```

再去看 brew 上面的版本，果然：

```sh
$ brew info deno
deno: stable 0.36.0 (bottled)
Command-line JavaScript / TypeScript engine
https://deno.land/
/usr/local/Cellar/deno/0.36.0 (9 files, 55.1MB) *
  Poured from bottle on 2020-05-17 at 14:31:34
From: https://mirrors.ustc.edu.cn/homebrew-core.git/Formula/deno.rb
==&gt; Dependencies
Build: ninja ✔, rust ✘
==&gt; Requirements
Build: xcode ✔
==&gt; Caveats
Bash completion has been installed to:
  /usr/local/etc/bash_completion.d

zsh completions have been installed to:
  /usr/local/share/zsh/site-functions
==&gt; Analytics
install: 13,653 (30 days), 20,861 (90 days), 37,002 (365 days)
install-on-request: 13,649 (30 days), 20,843 (90 days), 36,969 (365 days)
build-error: 0 (30 days)
```

之前一直有个习惯，安装完某个东西后会查看版本，以检查安装是否成功，顺便确定所装版本。这次栽了。

### 重新安装

使用 brew 安装前先 `brew update` 或不使用 brew，通过以下命令来安装：

```sh
$ curl -fsSL https://deno.land/x/install/install.sh | sh
```

<details>
<summary>
通过 curl 安装 deno 过程中的输出
</summary>

```sh
 curl -fsSL https://deno.land/x/install/install.sh | sh 

######################################################################## 100.0%
Archive:  /Users/wayou/.deno/bin/deno.zip
  inflating: deno
Deno was installed successfully to /Users/wayou/.deno/bin/deno
Manually add the directory to your $HOME/.bash_profile (or similar)
  export DENO_INSTALL="/Users/wayou/.deno"
  export PATH="$DENO_INSTALL/bin:$PATH"
Run '/Users/wayou/.deno/bin/deno --help' to get started
```

</details>

### 添加环境变量

如果使用 brew 安装可省略此步骤。

根据提示，需要将 deno 添加到环境变量中方可在命令行中执行：

```sh
  export DENO_INSTALL="/Users/wayou/.deno"
  export PATH="$DENO_INSTALL/bin:$PATH"
```

### 再次运行

检查安装：

```sh
$ deno -V
deno 1.0.0
```

现在对了，再次运行前面失败的示例：

```sh
$ deno run ./index.ts
Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts
error: Uncaught PermissionDenied: network access to "0.0.0.0:8000", run again with the --allow-net flag
    at unwrapResponse ($deno$/ops/dispatch_json.ts:43:11)
    at Object.sendSync ($deno$/ops/dispatch_json.ts:72:10)
    at Object.listen ($deno$/ops/net.ts:51:10)
    at listen ($deno$/net.ts:152:22)
    at serve (https://deno.land/std@0.50.0/http/server.ts:261:20)
    at file:///Users/wayou/work/dev/github/deno-demo/index.ts:2:11
```

还是报错，但错误不一样了。

### 权限问题

Deno 中对权限的要求更加细致，这里的命令需要给到网络权限。修正我们的命令再次运行：

```sh
$ deno run --allow-net ./index.ts
Compile file:///Users/wayou/work/dev/github/deno-demo/index.ts
http://localhost:8000/
```

访问 [http://localhost:8000/](http://localhost:8000/)，Demo 达成。


<img width="616" alt="Screen Shot 2020-05-17 at 18 56 41" src="https://user-images.githubusercontent.com/3783096/82142638-60710480-9870-11ea-8a56-122805f6c5ef.png" />
<p align="center">访问 Deno 启动的服务</p>


## What's next?

### 命令的自动补全

查看 deno 的帮助，发现其提供了各 shell 下的补全脚本，

```sh
$ deno -h
...
    completions    Generate shell completions
...
```

这就好玩了，对于 fish shell，其补全脚本为：

<details>
<summary>
fish shell 的 deno 补全脚本
</summary>


```sh
$ deno completions fish 
complete -c deno -n "__fish_use_subcommand" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_use_subcommand" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_use_subcommand" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_use_subcommand" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_use_subcommand" -f -a "bundle" -d 'Bundle module and dependencies into single file'
complete -c deno -n "__fish_use_subcommand" -f -a "completions" -d 'Generate shell completions'
complete -c deno -n "__fish_use_subcommand" -f -a "eval" -d 'Eval script'
complete -c deno -n "__fish_use_subcommand" -f -a "cache" -d 'Cache the dependencies'
complete -c deno -n "__fish_use_subcommand" -f -a "fmt" -d 'Format source files'
complete -c deno -n "__fish_use_subcommand" -f -a "info" -d 'Show info about cache or info related to source file'
complete -c deno -n "__fish_use_subcommand" -f -a "install" -d 'Install script as an executable'
complete -c deno -n "__fish_use_subcommand" -f -a "repl" -d 'Read Eval Print Loop'
complete -c deno -n "__fish_use_subcommand" -f -a "run" -d 'Run a program given a filename or url to the module'
complete -c deno -n "__fish_use_subcommand" -f -a "test" -d 'Run tests'
complete -c deno -n "__fish_use_subcommand" -f -a "types" -d 'Print runtime TypeScript declarations'
complete -c deno -n "__fish_use_subcommand" -f -a "upgrade" -d 'Upgrade deno executable to given version'
complete -c deno -n "__fish_use_subcommand" -f -a "doc" -d 'Show documentation for a module'
complete -c deno -n "__fish_use_subcommand" -f -a "help" -d 'Prints this message or the help of the given subcommand(s)'
complete -c deno -n "__fish_seen_subcommand_from bundle" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from bundle" -l importmap -d 'UNSTABLE: Load import map file'
complete -c deno -n "__fish_seen_subcommand_from bundle" -s c -l config -d 'Load tsconfig.json configuration file'
complete -c deno -n "__fish_seen_subcommand_from bundle" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from bundle" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from bundle" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from bundle" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from bundle" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from completions" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from completions" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from completions" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from completions" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from eval" -l inspect -d 'activate inspector on host:port (default: 127.0.0.1:9229)'
complete -c deno -n "__fish_seen_subcommand_from eval" -l inspect-brk -d 'activate inspector on host:port and break at start of user script'
complete -c deno -n "__fish_seen_subcommand_from eval" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from eval" -l v8-flags -d 'Set V8 command line options. For help: --v8-flags=--help'
complete -c deno -n "__fish_seen_subcommand_from eval" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from eval" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from eval" -s T -l ts -d 'Treat eval input as TypeScript'
complete -c deno -n "__fish_seen_subcommand_from eval" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from eval" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from eval" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from cache" -s r -l reload -d 'Reload source code cache (recompile TypeScript)'
complete -c deno -n "__fish_seen_subcommand_from cache" -l lock -d 'Check the specified lock file'
complete -c deno -n "__fish_seen_subcommand_from cache" -l importmap -d 'UNSTABLE: Load import map file'
complete -c deno -n "__fish_seen_subcommand_from cache" -s c -l config -d 'Load tsconfig.json configuration file'
complete -c deno -n "__fish_seen_subcommand_from cache" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from cache" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from cache" -l lock-write -d 'Write lock file. Use with --lock.'
complete -c deno -n "__fish_seen_subcommand_from cache" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from cache" -l no-remote -d 'Do not resolve remote modules'
complete -c deno -n "__fish_seen_subcommand_from cache" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from cache" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from cache" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from fmt" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from fmt" -l check -d 'Check if the source files are formatted.'
complete -c deno -n "__fish_seen_subcommand_from fmt" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from fmt" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from fmt" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from info" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from info" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from info" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from info" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from info" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from info" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from install" -l allow-read -d 'Allow file system read access'
complete -c deno -n "__fish_seen_subcommand_from install" -l allow-write -d 'Allow file system write access'
complete -c deno -n "__fish_seen_subcommand_from install" -l allow-net -d 'Allow network access'
complete -c deno -n "__fish_seen_subcommand_from install" -s n -l name -d 'Executable file name'
complete -c deno -n "__fish_seen_subcommand_from install" -l root -d 'Installation root'
complete -c deno -n "__fish_seen_subcommand_from install" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from install" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from install" -l allow-env -d 'Allow environment access'
complete -c deno -n "__fish_seen_subcommand_from install" -l allow-run -d 'Allow running subprocesses'
complete -c deno -n "__fish_seen_subcommand_from install" -l allow-plugin -d 'Allow loading plugins'
complete -c deno -n "__fish_seen_subcommand_from install" -l allow-hrtime -d 'Allow high resolution time measurement'
complete -c deno -n "__fish_seen_subcommand_from install" -s A -l allow-all -d 'Allow all permissions'
complete -c deno -n "__fish_seen_subcommand_from install" -s f -l force -d 'Forcefully overwrite existing installation'
complete -c deno -n "__fish_seen_subcommand_from install" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from install" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from install" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from install" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from repl" -l inspect -d 'activate inspector on host:port (default: 127.0.0.1:9229)'
complete -c deno -n "__fish_seen_subcommand_from repl" -l inspect-brk -d 'activate inspector on host:port and break at start of user script'
complete -c deno -n "__fish_seen_subcommand_from repl" -l v8-flags -d 'Set V8 command line options. For help: --v8-flags=--help'
complete -c deno -n "__fish_seen_subcommand_from repl" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from repl" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from repl" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from repl" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from repl" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from repl" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from run" -l inspect -d 'activate inspector on host:port (default: 127.0.0.1:9229)'
complete -c deno -n "__fish_seen_subcommand_from run" -l inspect-brk -d 'activate inspector on host:port and break at start of user script'
complete -c deno -n "__fish_seen_subcommand_from run" -l allow-read -d 'Allow file system read access'
complete -c deno -n "__fish_seen_subcommand_from run" -l allow-write -d 'Allow file system write access'
complete -c deno -n "__fish_seen_subcommand_from run" -l allow-net -d 'Allow network access'
complete -c deno -n "__fish_seen_subcommand_from run" -l importmap -d 'UNSTABLE: Load import map file'
complete -c deno -n "__fish_seen_subcommand_from run" -s r -l reload -d 'Reload source code cache (recompile TypeScript)'
complete -c deno -n "__fish_seen_subcommand_from run" -s c -l config -d 'Load tsconfig.json configuration file'
complete -c deno -n "__fish_seen_subcommand_from run" -l lock -d 'Check the specified lock file'
complete -c deno -n "__fish_seen_subcommand_from run" -l v8-flags -d 'Set V8 command line options. For help: --v8-flags=--help'
complete -c deno -n "__fish_seen_subcommand_from run" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from run" -l seed -d 'Seed Math.random()'
complete -c deno -n "__fish_seen_subcommand_from run" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from run" -l allow-env -d 'Allow environment access'
complete -c deno -n "__fish_seen_subcommand_from run" -l allow-run -d 'Allow running subprocesses'
complete -c deno -n "__fish_seen_subcommand_from run" -l allow-plugin -d 'Allow loading plugins'
complete -c deno -n "__fish_seen_subcommand_from run" -l allow-hrtime -d 'Allow high resolution time measurement'
complete -c deno -n "__fish_seen_subcommand_from run" -s A -l allow-all -d 'Allow all permissions'
complete -c deno -n "__fish_seen_subcommand_from run" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from run" -l lock-write -d 'Write lock file. Use with --lock.'
complete -c deno -n "__fish_seen_subcommand_from run" -l no-remote -d 'Do not resolve remote modules'
complete -c deno -n "__fish_seen_subcommand_from run" -l cached-only -d 'Require that remote dependencies are already cached'
complete -c deno -n "__fish_seen_subcommand_from run" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from run" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from run" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from test" -l inspect -d 'activate inspector on host:port (default: 127.0.0.1:9229)'
complete -c deno -n "__fish_seen_subcommand_from test" -l inspect-brk -d 'activate inspector on host:port and break at start of user script'
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-read -d 'Allow file system read access'
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-write -d 'Allow file system write access'
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-net -d 'Allow network access'
complete -c deno -n "__fish_seen_subcommand_from test" -l importmap -d 'UNSTABLE: Load import map file'
complete -c deno -n "__fish_seen_subcommand_from test" -s r -l reload -d 'Reload source code cache (recompile TypeScript)'
complete -c deno -n "__fish_seen_subcommand_from test" -s c -l config -d 'Load tsconfig.json configuration file'
complete -c deno -n "__fish_seen_subcommand_from test" -l lock -d 'Check the specified lock file'
complete -c deno -n "__fish_seen_subcommand_from test" -l v8-flags -d 'Set V8 command line options. For help: --v8-flags=--help'
complete -c deno -n "__fish_seen_subcommand_from test" -l cert -d 'Load certificate authority from PEM encoded file'
complete -c deno -n "__fish_seen_subcommand_from test" -l seed -d 'Seed Math.random()'
complete -c deno -n "__fish_seen_subcommand_from test" -l filter -d 'A pattern to filter the tests to run by'
complete -c deno -n "__fish_seen_subcommand_from test" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-env -d 'Allow environment access'
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-run -d 'Allow running subprocesses'
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-plugin -d 'Allow loading plugins'
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-hrtime -d 'Allow high resolution time measurement'
complete -c deno -n "__fish_seen_subcommand_from test" -s A -l allow-all -d 'Allow all permissions'
complete -c deno -n "__fish_seen_subcommand_from test" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from test" -l lock-write -d 'Write lock file. Use with --lock.'
complete -c deno -n "__fish_seen_subcommand_from test" -l no-remote -d 'Do not resolve remote modules'
complete -c deno -n "__fish_seen_subcommand_from test" -l cached-only -d 'Require that remote dependencies are already cached'
complete -c deno -n "__fish_seen_subcommand_from test" -l failfast -d 'Stop on first error'
complete -c deno -n "__fish_seen_subcommand_from test" -l allow-none -d 'Don\'t return error code if no test files are found'
complete -c deno -n "__fish_seen_subcommand_from test" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from test" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from test" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from types" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from types" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from types" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from types" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from types" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from upgrade" -l version -d 'The version to upgrade to'
complete -c deno -n "__fish_seen_subcommand_from upgrade" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from upgrade" -l dry-run -d 'Perform all checks without replacing old exe'
complete -c deno -n "__fish_seen_subcommand_from upgrade" -s f -l force -d 'Replace current exe even if not out-of-date'
complete -c deno -n "__fish_seen_subcommand_from upgrade" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from upgrade" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from doc" -s r -l reload -d 'Reload source code cache (recompile TypeScript)'
complete -c deno -n "__fish_seen_subcommand_from doc" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from doc" -l unstable -d 'Enable unstable APIs'
complete -c deno -n "__fish_seen_subcommand_from doc" -l json -d 'Output documentation in JSON format.'
complete -c deno -n "__fish_seen_subcommand_from doc" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from doc" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from doc" -s q -l quiet -d 'Suppress diagnostic output'
complete -c deno -n "__fish_seen_subcommand_from help" -s L -l log-level -d 'Set log level' -r -f -a "debug info"
complete -c deno -n "__fish_seen_subcommand_from help" -s h -l help -d 'Prints help information'
complete -c deno -n "__fish_seen_subcommand_from help" -s V -l version -d 'Prints version information'
complete -c deno -n "__fish_seen_subcommand_from help" -s q -l quiet -d 'Suppress diagnostic output'
```

</details>

将其制作成 fish 插件安装后，就可以通过 Tab 看到自动的命令提示了：

```sh
$ omf install https://github.com/wayou/plugin-deno
```

上面只是一点微小的工作，接下来，就是广大社区的拥趸们，开启又一轮造轮子狂欢热潮时候了。

其实一些轮子已经在路上了，[从 Node.js 移民 deno 指南](https://dev.to/aralroca/from-node-to-deno-5gpn#express--koa)。


从 Deno 证实了一些事情：

- TypeScript 大势所趋，不管喜欢与否。其实早在 2014 年 Angular2 就将这个趋势奠定了，实力诠释了一波无敌是多么的寂寞。
- 解决了 Ryan Dahl 在 [10 Things I Regret About Node.js ](https://medium.com/@imior/10-things-i-regret-about-node-js-ryan-dahl-2ba71ff6b4dc) 演讲中提到的 10 个问题。根据 bug 守恒，问题不会减少，它只是换了种形式。

## 相关资源

- [Deno 1.0](https://deno.land/v1)

    
</number></details>

  </div><a class="u-url" href="/2020/05/17/%E8%AF%95%E7%94%A8-Deno.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">牛さんの部落格</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">牛さんの部落格</li><li><a class="u-email" href="mailto:liuwayong@gmail.com">liuwayong@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>notes about the coding life</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
