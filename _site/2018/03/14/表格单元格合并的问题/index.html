<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="notes about the coding life">
    <meta name="keywords"  content="牛哇勇, 博客, 互联网, Web, JavaScript, 前端, 设计">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="表格单元格合并的问题 - 牛さんの部落格|刘哇勇的部落格">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="表格单元格合并的问题

背景

之前项目中使用 Angular ng-repeat 动态生成的表格有合并单元格的需求，所以在生成 td 标签时统一加了 rowspan 属性，具体的 span 值动态计算。如果不需要合并则返回 0。

调试完上线一切工作正常，至少用当时的 Chrome 来看，没发现问题。

但，最近有收到反馈表格展示不正常了。

本来应该是这个样子美如画的表格：



出现问...">
    
    <meta property="article:published_time" content="2018-03-14T15:03:00Z">
    
    
    
    <meta property="article:tag" content="bug">
    
    <meta property="article:tag" content="html">
    
    
    <meta property="og:image" content="http://0.0.0.0:4000">
    <meta property="og:url" content="http://0.0.0.0:4000/2018/03/14/%E8%A1%A8%E6%A0%BC%E5%8D%95%E5%85%83%E6%A0%BC%E5%90%88%E5%B9%B6%E7%9A%84%E9%97%AE%E9%A2%98/">
    <meta property="og:site_name" content="牛さんの部落格|刘哇勇的部落格">
    
    <title>表格单元格合并的问题 - 牛さんの部落格|刘哇勇的部落格</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://0.0.0.0:4000/2018/03/14/%E8%A1%A8%E6%A0%BC%E5%8D%95%E5%85%83%E6%A0%BC%E5%90%88%E5%B9%B6%E7%9A%84%E9%97%AE%E9%A2%98/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


  <!-- hack iOS CSS :active style -->
  <body ontouchstart="">
    <!-- Navigation -->

    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">牛さんの部落格</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div id="huxblog_navbar">
                <div class="navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/">Home</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="/about/">关于</a>
                        </li>
                        
                        
                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li class="search-icon">
                            <a href="javascript:void(0)">
                                <i class="fa fa-search"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <script>
        // Drop Bootstarp low-performance Navbar
        // Use customize navbar with high-quality material design animation
        // in high-perf jank-free CSS3 implementation
        var $body = document.body;
        var $toggle = document.querySelector('.navbar-toggle');
        var $navbar = document.querySelector('#huxblog_navbar');
        var $collapse = document.querySelector('.navbar-collapse');

        var __HuxNav__ = {
            close: function () {
                $navbar.className = " ";
                // wait until animation end.
                setTimeout(function () {
                    // prevent frequently toggle
                    if ($navbar.className.indexOf('in') < 0) {
                        $collapse.style.height = "0px"
                    }
                }, 400)
            },
            open: function () {
                $collapse.style.height = "auto"
                $navbar.className += " in";
            }
        }

        // Bind Event
        $toggle.addEventListener('click', function (e) {
            if ($navbar.className.indexOf('in') > 0) {
                __HuxNav__.close()
            } else {
                __HuxNav__.open()
            }
        })

        /**
         * Since Fastclick is used to delegate 'touchstart' globally
         * to hack 300ms delay in iOS by performing a fake 'click',
         * Using 'e.stopPropagation' to stop 'touchstart' event from 
         * $toggle/$collapse will break global delegation.
         * 
         * Instead, we use a 'e.target' filter to prevent handler
         * added to document close HuxNav.  
         *
         * Also, we use 'click' instead of 'touchstart' as compromise
         */
        document.addEventListener('click', function (e) {
            if (e.target == $toggle) return;
            if (e.target.className == 'icon-bar') return;
            __HuxNav__.close();
        })
    </script> <!-- Search -->
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div> <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg');
        background: ;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=bug" title="bug">bug</a>
                        
                        <a class="tag" href="/archive/?tag=html" title="html">html</a>
                        
                    </div>
                    <h1>表格单元格合并的问题</h1>
                    
                    <h2 class="subheading"></h2>
                    <span class="meta">Posted by 牛さんの部落格 on March 14, 2018</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<h2 id="表格单元格合并的问题">表格单元格合并的问题</h2>

<h3 id="背景">背景</h3>

<p>之前项目中使用 Angular <code class="language-plaintext highlighter-rouge">ng-repeat</code> 动态生成的表格有合并单元格的需求，所以在生成 <code class="language-plaintext highlighter-rouge">td</code> 标签时统一加了 <code class="language-plaintext highlighter-rouge">rowspan</code> 属性，具体的 span 值动态计算。如果不需要合并则返回 0。</p>

<p>调试完上线一切工作正常，至少用当时的 Chrome 来看，没发现问题。</p>

<p>但，最近有收到反馈表格展示不正常了。</p>

<p>本来应该是这个样子美如画的表格：</p>

<p><img src="https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/table-rowspan/assets/normal-table.png" alt="" /></p>

<p>出现问题后的表格成了这样子：</p>

<p><img src="https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/table-rowspan/assets/broken-table.png" alt="" /></p>

<p>相信很难从这个出问题表格在脑海中还原其率真美丽的样子。</p>

<h3 id="领悟">领悟</h3>

<p>当看到这个问题后，男人的直觉告诉我，这是一个兼容性问题。但万万没想到是向前兼容的问题！因为发现是升级到新版 Chrome 后才会出现。</p>

<p>对于事后找出的原因，着实有点猝不及防。毕竟平日里解决了无数向后兼容老浏览器的问题，这种向前因为新版浏览器才出现的问题还真是活久见。</p>

<p>在 JSFiddle 上面制作了一个简化版的 <a href="http://jsfiddle.net/Wayou/jt5Lwp9a/">Demo</a> 将场景还原，方便观察。</p>

<p>其中每个表格单元格都通过 <code class="language-plaintext highlighter-rouge">ng-repeat</code> 动态生成。其 <code class="language-plaintext highlighter-rouge">rowspan</code> 值也根据数据计算，当发生 <code class="language-plaintext highlighter-rouge">rowspan</code> 时后续表格行中单元是否该展示也是计算得当的。</p>

<p>所以正常来看，展示还是很完美的。下面是升级前 Chrome 64 中的效果：</p>

<p><img src="https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/table-rowspan/assets/normal.png" alt="" /></p>

<p>生成的表格代码如下：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>name<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>age<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">"0"</span><span class="nt">&gt;</span>foo<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">"3"</span><span class="nt">&gt;</span>29<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">"0"</span><span class="nt">&gt;</span>bar<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">"0"</span><span class="nt">&gt;</span>baz<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div></div>

<p>而在升级到 Chrome 65 后是这样子的：</p>

<p><img src="https://raw.githubusercontent.com/wayou/wayou.github.io/master/posts/table-rowspan/assets/broken.png" alt="" /></p>

<p>可以看到，后续的几行蹿到了和第一行齐头并进的位置。</p>

<p>经过调试发现，如果只在需要合并的单元格的 <code class="language-plaintext highlighter-rouge">td</code> 标签上指定 <code class="language-plaintext highlighter-rouge">rowspan</code> 属性，其他 <code class="language-plaintext highlighter-rouge">td</code> 标签不写该属性，就正常了。所以其他单元格身上多余的 <code class="language-plaintext highlighter-rouge">rowspan="0"</code> 导致了新版 Chrome 下展示不正常了，可能新版中对非法 HTML 的容忍度——降低了？！</p>

<h3 id="表格的合并属性">表格的合并属性</h3>

<p>讲道理，如果单元格不需要合并，那正常来说是不需要指定合并属性（<code class="language-plaintext highlighter-rouge">rowspan</code>, <code class="language-plaintext highlighter-rouge">colspan</code>）的。但是，如果指定了，并且值为 0，按照字面意思，应该也等同于不合并才对。并且，之前的 Chrome 中确实是这样表现的。</p>

<p>那么这个属性的取值，究竟有何玄机？看来，是时候严肃地了解一下表格单元格的合并属性了。带着疑问我决定去 Google 一下。</p>

<p>首先， 地位堪比山东蓝翔的前端网校 <a href="https://www.w3schools.com/tags/att_td_rowspan.asp">W3school 在介绍 rowspan</a> 时给出了这样一句有用的注释：</p>

<blockquote>
  <p><em>Note</em>: rowspan=”0” tells the browser to span the cell to the last row of the table section (thead, tbody, or tfoot)</p>
</blockquote>

<p>再去看看 <a href="https://www.w3.org/TR/html401/struct/tables.html#adef-rowspan">W3C 的解释</a>，毕竟更权威。上面的文档这样说道：</p>

<blockquote>
  <p>This attribute specifies the number of rows spanned by the current cell. The default value of this attribute is one (“1”). The value zero (“0”) means that the cell spans all rows from the current row to the last row of the table section (THEAD, TBODY, or TFOOT) in which the cell is defined.</p>
</blockquote>

<p>看来表述和蓝翔网校是一致的，即，指定 <code class="language-plaintext highlighter-rouge">rowspan=“0”</code> 时表示合并当前单元格直到表格的最后一行。</p>

<p>只能说太年轻，对这个属性的理解不够深，还是太想当然了。如果说之前写成 <code class="language-plaintext highlighter-rouge">rowspan=“0”</code> 是错误的，那应该达不到需要的表现才对，只能说 Chrome 54 及其他老版本浏览器也不太厚道了，没有按照规范来解析。</p>

<p>注意到上面 W3C 的介绍中的提及了该属性默认值是 1，也就是说如果想要不发生合并，正常的值应该给 1才对，而不是 0。</p>

<h3 id="结论">结论</h3>

<p>所以，生成表格时将不需要合并的单元格其 <code class="language-plaintext highlighter-rouge">rowspan</code> 值指定为默认的 1 后，问题得以解决。</p>

<p>生成的表格看起来像是这样：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>name<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>age<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">“1”</span><span class="nt">&gt;</span>foo<span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">"3"</span><span class="nt">&gt;</span>29<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">“1”</span><span class="nt">&gt;</span>bar<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">rowspan=</span><span class="s">“1”</span><span class="nt">&gt;</span>baz<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</code></pre></div></div>

<p>其实也不算向前兼容的问题，毕竟规范一直是那样，只是浏览器解析展示更贴近规范，要求代码也需要同步地贴近规范。</p>

<h3 id="相关资源">相关资源</h3>

<ul>
  <li><a href="https://www.w3.org/TR/html401/struct/tables.html#adef-rowspan">W3C rowspan</a></li>
  <li><a href="https://www.w3schools.com/tags/att_td_rowspan.asp">W3school rowspan</a></li>
</ul>



                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2018/03/13/Chrome-DevTools-%E4%B8%AD%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E7%9A%84%E8%B0%83%E8%AF%95-%E8%AE%A9%E7%9B%B8%E5%AE%9C%E4%B9%9F%E4%B8%8D%E5%86%8D%E7%9A%B1%E7%9C%89/" data-toggle="tooltip" data-placement="top" title="Chrome DevTools 中内存溢出的调试，让相宜也不再皱眉">
                        Previous<br>
                        <span>Chrome DevTools 中内存溢出的调试，让相宜也不再皱眉</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2018/04/01/%E4%B8%80%E4%BB%BD%E6%9C%89%E7%82%B9%E8%BF%87%E6%97%B6%E7%9A%84-JS-%E9%A3%8E%E6%A0%BC%E6%8C%87%E5%8D%97-Google-JavaScript-Style-Guide/" data-toggle="tooltip" data-placement="top" title="一份有点过时的 JS 风格指南 - Google JavaScript Style Guide">
                        Next<br>
                        <span>一份有点过时的 JS 风格指南 - Google JavaScript Style Guide</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                



                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->









<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'right',
          // icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

 <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  <li>
    <a href="/feed.xml">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a href="https://twitter.com/liuwayong">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  
  
  
  <li>
    <a target="_blank" href="https://github.com/wayou">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; 牛さんの部落格 2020
                    <br>
                    Powered by <a href="http://huangxuan.me">Hux Blog</a> |
                    <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="100px"
                        height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true">
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Simple Jekyll Search -->
<script src="/js/simple-jekyll-search.min.js"></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->







<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog(selector) {

        // interop with multilangual 
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->


<!-- Simple Jekyll Search -->
<script>
    // https://stackoverflow.com/questions/1912501/unescape-html-entities-in-javascript
    function htmlDecode(input) {
        var e = document.createElement('textarea');
        e.innerHTML = input;
        // handle case of empty input
        return e.childNodes.length === 0 ? "" : e.childNodes[0].nodeValue;
    }

    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/search.json',
        searchResultTemplate: '<div class="post-preview item"><a href="{url}"><h2 class="post-title">{title}</h2><h3 class="post-subtitle">{subtitle}</h3><hr></a></div>',
        noResultsText: 'No results',
        limit: 50,
        fuzzy: false,
        // a hack to get escaped subtitle unescaped. for some reason, 
        // post.subtitle w/o escape filter nuke entire search.
        templateMiddleware: function (prop, value, template) {
            if (prop === 'subtitle' || prop === 'title') {
                if (value.indexOf("code")) {
                    return htmlDecode(value);
                } else {
                    return value;
                }
            }
        }
    });

    $(document).ready(function () {
        var $searchPage = $('.search-page');
        var $searchOpen = $('.search-icon');
        var $searchClose = $('.search-icon-close');
        var $searchInput = $('#search-input');
        var $body = $('body');

        $searchOpen.on('click', function (e) {
            e.preventDefault();
            $searchPage.toggleClass('search-active');
            var prevClasses = $body.attr('class') || '';
            setTimeout(function () {
                $body.addClass('no-scroll');
            }, 400)

            if ($searchPage.hasClass('search-active')) {
                $searchClose.on('click', function (e) {
                    e.preventDefault();
                    $searchPage.removeClass('search-active');
                    $body.attr('class', prevClasses);  // from closure 
                });
                $searchInput.focus();
            }
        });
    });
</script>
  </body>
</html>
