<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>利用 SASS 简化 nth-child 样式的生成 | 牛さんの部落格</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="利用 SASS 简化 nth-child 样式的生成" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="利用 SASS 简化 nth-child 样式的生成 考察如下的 HTML 片段，通过 CSS 的 nth-child() 伪选择器实现列表的颜色循环，比如每三个一次循环。 &lt;ul&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;/ul&gt; 很容易地，我们能得出如下样式代码： ul { li:nth-child(3n + 1) { color: indigo; } li:nth-child(3n + 2) { color: red; } li:nth-child(3n + 3) { color: green; } } 以上，只三种颜色循环，简单情况下可这样处理。但样式多起来之后，上面代码显得很臃肿且不易维护。 既然是使用 SASS，很容易想到可通过编写循环语句来将其简化。 循环过程就是遍历一个预设的颜色列表，为每一个颜色生成相应的样式。 List &amp; Map 首先需要定义一个对象来保存预设的颜色列表，SASS 中的 Lists 可满足条件。 $colors: indigo, red, green; 使用上面的 list: $colors: indigo, red, green; @each $color in $colors { .color-#{$color} { color: $color; } } 编译后输出： .color-indigo { color: indigo; } .color-red { color: red; } .color-green { color: green; } 当然，也可以定义 Map 类型，为每种颜色指定名字，这样使用的时候比较语义： $colors: ( &quot;indigo&quot;: indigo, &quot;red&quot;: red, &quot;green&quot;: green ); @each $name, $color in $colors { .color-#{$name} { color: $color; } } 索引 列表对象及其遍历如上，现在还需要在遍历过程中获得一个 index 索引值，用于生成 3*n+index。 通过 index() 函数可以达到目的： $colors: (indigo, red, green); @each $color in $colors { $index: index($colors, $color); .color-#{$index} { color: $color; } } 编译后输出： .color-1 { color: indigo; } .color-2 { color: red; } .color-3 { color: green; } 生成 nth-child 样式 结合上面所有，可以得出生成 nth-child 样式的代码： $colors: (indigo, red, green); ul { @each $color in $colors { $index: index($colors, $color); li:nth-child(3n + #{$index}) { color: $color; } } } 编译后输出： ul li:nth-child(3n + 1) { color: indigo; } ul li:nth-child(3n + 2) { color: red; } ul li:nth-child(3n + 3) { color: green; } 注意到 nth-child(3n + #{$index}) 中的 3 是硬编码。既然我们的颜色是在一个数组中，所以我们是知道总个数的，也就能替换掉这里硬编码的写法。 通过 length() 函数可获得 list 的长度。改进后的代码如下： $colors: (indigo, red, green); ul { @each $color in $colors { $index: index($colors, $color); li:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } 这样，如果后续有颜色增加，或顺序的调整，我们只需要更新 $colors 变量的值即可。 @mixin 进一步，我们可以将上面遍历生成 nth-child 的代码抽取成 mixin，这样可以被其他地方使用。 $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); li:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } ul { @include nth-color; } mixin 的优化 但像上面这样还不能达到完全公用，因为 mixin 中使用了 li 选择器，不是所有需要 nth-child 样式的地方，都使用的 li 元素，所以此处需要进行优化，使得 mixin 中的这部分内容灵活一点，以适用不同的使用环境。 首先，使用 &amp; 父选择器便可快速解决，这样生成的样式便由包含这个 mixin 的选择器决定了。 $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } ul { li { @include nth-color; } } 诚然，这样修改过后，确实可以将该 mixin 使用于多个地方了。 但考虑这么一种情况，因为上面列表比较简单，更加常见的情况是，列表中是另外复杂的元素，而不是单纯的一个元素，比如像下面这样： &lt;ul&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; 现在想针对列表元素中的 h3 进行颜色的设置，即 nth-child 中设置的 color 只针对 h3 而不是整个 li 元素。 结合前面的优化，似乎可以这样写： $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); - &amp;:nth-child(#{length($colors)}n + #{$index}) { + &amp;:nth-child(#{length($colors)}n + #{$index}) h3{ color: $color; } } } ul { li { @include nth-color; } } 编译后的结果： ul li:nth-child(3n+1) h3 { color: indigo; } ul li:nth-child(3n+2) h3 { color: red; } ul li:nth-child(3n+3) h3 { color: green; } 从结果来看，达到了目标。但又在 nth-color 这个 mixin 中引入了 h3，使其变得不再通用，问题又回到了之前。 所以 &amp; 只解决了 nth-child 父级嵌套的问题，对于 nth-child 后面还需要自定义选择器的情况，就需要用别的方式进一步优化。 给 @mixin 传参 mixin 是可以接收参数的，通过外部传递选择器进来，可以达到将 h3 从 mixin 从剥离的目的。 @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child}{ color: $color; } } } ul { li { @include nth-color(&quot;h3&quot;); } } 从 @mixin 将参数传递到外面 最后，nth-color 这个 mixin 还有一处不够灵活的地方，便是其样式内容。 现在在其中写死了只有一个 color: $color; 属性，也就是说，使用该 mixin 的地方只能用它来设置元素的字色。如果 mixin 能够将颜色传递出来，这样外部使用的时候就可以用到其他属性上，更加的灵活了。 SASS 确实也提供了这么种机制，即 mixin 能够身外传递参数，借助 @content 指令。 @content 指令指代调用 mixin 时书写的模式内容部分。如下的代码直观展示了其功能： @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child}{ color: $color; + @content; } } } ul { li { - @include nth-color(&quot;h3&quot;) + @include nth-color(&quot;h3&quot;){ + border:1px solid orange; + }; } } 编译后内容为： ul li:nth-child(3n+1) h3 { color: indigo; border: 1px solid orange; } ul li:nth-child(3n+2) h3 { color: red; border: 1px solid orange; } ul li:nth-child(3n+3) h3 { color: green; border: 1px solid orange; } 可以看到，外部书写的 border: 1px solid orange; 通过 @content 指代而放进了每个 nth-child 样式中。只是这个 border 的颜色现在还是写死的 orange，现在来将其设置成跟随相应的字色，即跟着 color 属性走。 当我们使用 @content(&lt;arguments...&gt;) 形式的 @content 时，可以传递一些参数，外部调用该 mixin 时需要使用如下形式来获取传递的参数： @include &lt;name&gt; using (&lt;arguments...&gt;) NOTE：：这里的 using 语法只部分 SASS 实现（Dart Sass since 1.15.0, LibSass, Ruby Sass）中有支持，node-sass 还没有。 最终的 mixin 所以，最终版的代码为： $colors: (indigo, red, green); @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child} { color: $color; @content ($color); } } } ul { li { @include nth-color(&quot;h3&quot;) using($color) { border: 1px solid #{$color}; } } } 编译后得到的 CSS： ul li:nth-child(3n+1) h3 { color: indigo; border: 1px solid indigo; } ul li:nth-child(3n+2) h3 { color: red; border: 1px solid red; } ul li:nth-child(3n+3) h3 { color: green; border: 1px solid green; } 总结 通过将生成 nth-child 样式的规则自动化的过程中，顺带使用了 SASS 中另外一些特性， 定义和使用数组及对象 数组及对象的遍历 遍历过程中索引的获取 @mixin 的使用，参数的传递 @mixin 中 @content 的使用 @mixin 中向外传递参数 相关资源 :nth-child() SASS documentation - Lists SASS documentation - Maps @content" />
<meta property="og:description" content="利用 SASS 简化 nth-child 样式的生成 考察如下的 HTML 片段，通过 CSS 的 nth-child() 伪选择器实现列表的颜色循环，比如每三个一次循环。 &lt;ul&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;/ul&gt; 很容易地，我们能得出如下样式代码： ul { li:nth-child(3n + 1) { color: indigo; } li:nth-child(3n + 2) { color: red; } li:nth-child(3n + 3) { color: green; } } 以上，只三种颜色循环，简单情况下可这样处理。但样式多起来之后，上面代码显得很臃肿且不易维护。 既然是使用 SASS，很容易想到可通过编写循环语句来将其简化。 循环过程就是遍历一个预设的颜色列表，为每一个颜色生成相应的样式。 List &amp; Map 首先需要定义一个对象来保存预设的颜色列表，SASS 中的 Lists 可满足条件。 $colors: indigo, red, green; 使用上面的 list: $colors: indigo, red, green; @each $color in $colors { .color-#{$color} { color: $color; } } 编译后输出： .color-indigo { color: indigo; } .color-red { color: red; } .color-green { color: green; } 当然，也可以定义 Map 类型，为每种颜色指定名字，这样使用的时候比较语义： $colors: ( &quot;indigo&quot;: indigo, &quot;red&quot;: red, &quot;green&quot;: green ); @each $name, $color in $colors { .color-#{$name} { color: $color; } } 索引 列表对象及其遍历如上，现在还需要在遍历过程中获得一个 index 索引值，用于生成 3*n+index。 通过 index() 函数可以达到目的： $colors: (indigo, red, green); @each $color in $colors { $index: index($colors, $color); .color-#{$index} { color: $color; } } 编译后输出： .color-1 { color: indigo; } .color-2 { color: red; } .color-3 { color: green; } 生成 nth-child 样式 结合上面所有，可以得出生成 nth-child 样式的代码： $colors: (indigo, red, green); ul { @each $color in $colors { $index: index($colors, $color); li:nth-child(3n + #{$index}) { color: $color; } } } 编译后输出： ul li:nth-child(3n + 1) { color: indigo; } ul li:nth-child(3n + 2) { color: red; } ul li:nth-child(3n + 3) { color: green; } 注意到 nth-child(3n + #{$index}) 中的 3 是硬编码。既然我们的颜色是在一个数组中，所以我们是知道总个数的，也就能替换掉这里硬编码的写法。 通过 length() 函数可获得 list 的长度。改进后的代码如下： $colors: (indigo, red, green); ul { @each $color in $colors { $index: index($colors, $color); li:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } 这样，如果后续有颜色增加，或顺序的调整，我们只需要更新 $colors 变量的值即可。 @mixin 进一步，我们可以将上面遍历生成 nth-child 的代码抽取成 mixin，这样可以被其他地方使用。 $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); li:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } ul { @include nth-color; } mixin 的优化 但像上面这样还不能达到完全公用，因为 mixin 中使用了 li 选择器，不是所有需要 nth-child 样式的地方，都使用的 li 元素，所以此处需要进行优化，使得 mixin 中的这部分内容灵活一点，以适用不同的使用环境。 首先，使用 &amp; 父选择器便可快速解决，这样生成的样式便由包含这个 mixin 的选择器决定了。 $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } ul { li { @include nth-color; } } 诚然，这样修改过后，确实可以将该 mixin 使用于多个地方了。 但考虑这么一种情况，因为上面列表比较简单，更加常见的情况是，列表中是另外复杂的元素，而不是单纯的一个元素，比如像下面这样： &lt;ul&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; 现在想针对列表元素中的 h3 进行颜色的设置，即 nth-child 中设置的 color 只针对 h3 而不是整个 li 元素。 结合前面的优化，似乎可以这样写： $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); - &amp;:nth-child(#{length($colors)}n + #{$index}) { + &amp;:nth-child(#{length($colors)}n + #{$index}) h3{ color: $color; } } } ul { li { @include nth-color; } } 编译后的结果： ul li:nth-child(3n+1) h3 { color: indigo; } ul li:nth-child(3n+2) h3 { color: red; } ul li:nth-child(3n+3) h3 { color: green; } 从结果来看，达到了目标。但又在 nth-color 这个 mixin 中引入了 h3，使其变得不再通用，问题又回到了之前。 所以 &amp; 只解决了 nth-child 父级嵌套的问题，对于 nth-child 后面还需要自定义选择器的情况，就需要用别的方式进一步优化。 给 @mixin 传参 mixin 是可以接收参数的，通过外部传递选择器进来，可以达到将 h3 从 mixin 从剥离的目的。 @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child}{ color: $color; } } } ul { li { @include nth-color(&quot;h3&quot;); } } 从 @mixin 将参数传递到外面 最后，nth-color 这个 mixin 还有一处不够灵活的地方，便是其样式内容。 现在在其中写死了只有一个 color: $color; 属性，也就是说，使用该 mixin 的地方只能用它来设置元素的字色。如果 mixin 能够将颜色传递出来，这样外部使用的时候就可以用到其他属性上，更加的灵活了。 SASS 确实也提供了这么种机制，即 mixin 能够身外传递参数，借助 @content 指令。 @content 指令指代调用 mixin 时书写的模式内容部分。如下的代码直观展示了其功能： @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child}{ color: $color; + @content; } } } ul { li { - @include nth-color(&quot;h3&quot;) + @include nth-color(&quot;h3&quot;){ + border:1px solid orange; + }; } } 编译后内容为： ul li:nth-child(3n+1) h3 { color: indigo; border: 1px solid orange; } ul li:nth-child(3n+2) h3 { color: red; border: 1px solid orange; } ul li:nth-child(3n+3) h3 { color: green; border: 1px solid orange; } 可以看到，外部书写的 border: 1px solid orange; 通过 @content 指代而放进了每个 nth-child 样式中。只是这个 border 的颜色现在还是写死的 orange，现在来将其设置成跟随相应的字色，即跟着 color 属性走。 当我们使用 @content(&lt;arguments...&gt;) 形式的 @content 时，可以传递一些参数，外部调用该 mixin 时需要使用如下形式来获取传递的参数： @include &lt;name&gt; using (&lt;arguments...&gt;) NOTE：：这里的 using 语法只部分 SASS 实现（Dart Sass since 1.15.0, LibSass, Ruby Sass）中有支持，node-sass 还没有。 最终的 mixin 所以，最终版的代码为： $colors: (indigo, red, green); @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child} { color: $color; @content ($color); } } } ul { li { @include nth-color(&quot;h3&quot;) using($color) { border: 1px solid #{$color}; } } } 编译后得到的 CSS： ul li:nth-child(3n+1) h3 { color: indigo; border: 1px solid indigo; } ul li:nth-child(3n+2) h3 { color: red; border: 1px solid red; } ul li:nth-child(3n+3) h3 { color: green; border: 1px solid green; } 总结 通过将生成 nth-child 样式的规则自动化的过程中，顺带使用了 SASS 中另外一些特性， 定义和使用数组及对象 数组及对象的遍历 遍历过程中索引的获取 @mixin 的使用，参数的传递 @mixin 中 @content 的使用 @mixin 中向外传递参数 相关资源 :nth-child() SASS documentation - Lists SASS documentation - Maps @content" />
<link rel="canonical" href="http://localhost:4000/2019/10/15/%E5%88%A9%E7%94%A8-SASS-%E7%AE%80%E5%8C%96-nth-child-%E6%A0%B7%E5%BC%8F%E7%9A%84%E7%94%9F%E6%88%90.html" />
<meta property="og:url" content="http://localhost:4000/2019/10/15/%E5%88%A9%E7%94%A8-SASS-%E7%AE%80%E5%8C%96-nth-child-%E6%A0%B7%E5%BC%8F%E7%9A%84%E7%94%9F%E6%88%90.html" />
<meta property="og:site_name" content="牛さんの部落格" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-15T03:10:00+08:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/2019/10/15/%E5%88%A9%E7%94%A8-SASS-%E7%AE%80%E5%8C%96-nth-child-%E6%A0%B7%E5%BC%8F%E7%9A%84%E7%94%9F%E6%88%90.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/10/15/%E5%88%A9%E7%94%A8-SASS-%E7%AE%80%E5%8C%96-nth-child-%E6%A0%B7%E5%BC%8F%E7%9A%84%E7%94%9F%E6%88%90.html"},"description":"利用 SASS 简化 nth-child 样式的生成 考察如下的 HTML 片段，通过 CSS 的 nth-child() 伪选择器实现列表的颜色循环，比如每三个一次循环。 &lt;ul&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt; &lt;li&gt;6&lt;/li&gt; &lt;/ul&gt; 很容易地，我们能得出如下样式代码： ul { li:nth-child(3n + 1) { color: indigo; } li:nth-child(3n + 2) { color: red; } li:nth-child(3n + 3) { color: green; } } 以上，只三种颜色循环，简单情况下可这样处理。但样式多起来之后，上面代码显得很臃肿且不易维护。 既然是使用 SASS，很容易想到可通过编写循环语句来将其简化。 循环过程就是遍历一个预设的颜色列表，为每一个颜色生成相应的样式。 List &amp; Map 首先需要定义一个对象来保存预设的颜色列表，SASS 中的 Lists 可满足条件。 $colors: indigo, red, green; 使用上面的 list: $colors: indigo, red, green; @each $color in $colors { .color-#{$color} { color: $color; } } 编译后输出： .color-indigo { color: indigo; } .color-red { color: red; } .color-green { color: green; } 当然，也可以定义 Map 类型，为每种颜色指定名字，这样使用的时候比较语义： $colors: ( &quot;indigo&quot;: indigo, &quot;red&quot;: red, &quot;green&quot;: green ); @each $name, $color in $colors { .color-#{$name} { color: $color; } } 索引 列表对象及其遍历如上，现在还需要在遍历过程中获得一个 index 索引值，用于生成 3*n+index。 通过 index() 函数可以达到目的： $colors: (indigo, red, green); @each $color in $colors { $index: index($colors, $color); .color-#{$index} { color: $color; } } 编译后输出： .color-1 { color: indigo; } .color-2 { color: red; } .color-3 { color: green; } 生成 nth-child 样式 结合上面所有，可以得出生成 nth-child 样式的代码： $colors: (indigo, red, green); ul { @each $color in $colors { $index: index($colors, $color); li:nth-child(3n + #{$index}) { color: $color; } } } 编译后输出： ul li:nth-child(3n + 1) { color: indigo; } ul li:nth-child(3n + 2) { color: red; } ul li:nth-child(3n + 3) { color: green; } 注意到 nth-child(3n + #{$index}) 中的 3 是硬编码。既然我们的颜色是在一个数组中，所以我们是知道总个数的，也就能替换掉这里硬编码的写法。 通过 length() 函数可获得 list 的长度。改进后的代码如下： $colors: (indigo, red, green); ul { @each $color in $colors { $index: index($colors, $color); li:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } 这样，如果后续有颜色增加，或顺序的调整，我们只需要更新 $colors 变量的值即可。 @mixin 进一步，我们可以将上面遍历生成 nth-child 的代码抽取成 mixin，这样可以被其他地方使用。 $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); li:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } ul { @include nth-color; } mixin 的优化 但像上面这样还不能达到完全公用，因为 mixin 中使用了 li 选择器，不是所有需要 nth-child 样式的地方，都使用的 li 元素，所以此处需要进行优化，使得 mixin 中的这部分内容灵活一点，以适用不同的使用环境。 首先，使用 &amp; 父选择器便可快速解决，这样生成的样式便由包含这个 mixin 的选择器决定了。 $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) { color: $color; } } } ul { li { @include nth-color; } } 诚然，这样修改过后，确实可以将该 mixin 使用于多个地方了。 但考虑这么一种情况，因为上面列表比较简单，更加常见的情况是，列表中是另外复杂的元素，而不是单纯的一个元素，比如像下面这样： &lt;ul&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;div className=&quot;item&quot;&gt; &lt;h3&gt;title&lt;/h3&gt; &lt;div&gt;desc goes here...&lt;/div&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; 现在想针对列表元素中的 h3 进行颜色的设置，即 nth-child 中设置的 color 只针对 h3 而不是整个 li 元素。 结合前面的优化，似乎可以这样写： $colors: (indigo, red, green); @mixin nth-color { @each $color in $colors { $index: index($colors, $color); - &amp;:nth-child(#{length($colors)}n + #{$index}) { + &amp;:nth-child(#{length($colors)}n + #{$index}) h3{ color: $color; } } } ul { li { @include nth-color; } } 编译后的结果： ul li:nth-child(3n+1) h3 { color: indigo; } ul li:nth-child(3n+2) h3 { color: red; } ul li:nth-child(3n+3) h3 { color: green; } 从结果来看，达到了目标。但又在 nth-color 这个 mixin 中引入了 h3，使其变得不再通用，问题又回到了之前。 所以 &amp; 只解决了 nth-child 父级嵌套的问题，对于 nth-child 后面还需要自定义选择器的情况，就需要用别的方式进一步优化。 给 @mixin 传参 mixin 是可以接收参数的，通过外部传递选择器进来，可以达到将 h3 从 mixin 从剥离的目的。 @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child}{ color: $color; } } } ul { li { @include nth-color(&quot;h3&quot;); } } 从 @mixin 将参数传递到外面 最后，nth-color 这个 mixin 还有一处不够灵活的地方，便是其样式内容。 现在在其中写死了只有一个 color: $color; 属性，也就是说，使用该 mixin 的地方只能用它来设置元素的字色。如果 mixin 能够将颜色传递出来，这样外部使用的时候就可以用到其他属性上，更加的灵活了。 SASS 确实也提供了这么种机制，即 mixin 能够身外传递参数，借助 @content 指令。 @content 指令指代调用 mixin 时书写的模式内容部分。如下的代码直观展示了其功能： @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child}{ color: $color; + @content; } } } ul { li { - @include nth-color(&quot;h3&quot;) + @include nth-color(&quot;h3&quot;){ + border:1px solid orange; + }; } } 编译后内容为： ul li:nth-child(3n+1) h3 { color: indigo; border: 1px solid orange; } ul li:nth-child(3n+2) h3 { color: red; border: 1px solid orange; } ul li:nth-child(3n+3) h3 { color: green; border: 1px solid orange; } 可以看到，外部书写的 border: 1px solid orange; 通过 @content 指代而放进了每个 nth-child 样式中。只是这个 border 的颜色现在还是写死的 orange，现在来将其设置成跟随相应的字色，即跟着 color 属性走。 当我们使用 @content(&lt;arguments...&gt;) 形式的 @content 时，可以传递一些参数，外部调用该 mixin 时需要使用如下形式来获取传递的参数： @include &lt;name&gt; using (&lt;arguments...&gt;) NOTE：：这里的 using 语法只部分 SASS 实现（Dart Sass since 1.15.0, LibSass, Ruby Sass）中有支持，node-sass 还没有。 最终的 mixin 所以，最终版的代码为： $colors: (indigo, red, green); @mixin nth-color($child) { @each $color in $colors { $index: index($colors, $color); &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child} { color: $color; @content ($color); } } } ul { li { @include nth-color(&quot;h3&quot;) using($color) { border: 1px solid #{$color}; } } } 编译后得到的 CSS： ul li:nth-child(3n+1) h3 { color: indigo; border: 1px solid indigo; } ul li:nth-child(3n+2) h3 { color: red; border: 1px solid red; } ul li:nth-child(3n+3) h3 { color: green; border: 1px solid green; } 总结 通过将生成 nth-child 样式的规则自动化的过程中，顺带使用了 SASS 中另外一些特性， 定义和使用数组及对象 数组及对象的遍历 遍历过程中索引的获取 @mixin 的使用，参数的传递 @mixin 中 @content 的使用 @mixin 中向外传递参数 相关资源 :nth-child() SASS documentation - Lists SASS documentation - Maps @content","@type":"BlogPosting","headline":"利用 SASS 简化 nth-child 样式的生成","dateModified":"2019-10-15T03:10:00+08:00","datePublished":"2019-10-15T03:10:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="牛さんの部落格" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">牛さんの部落格</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">利用 SASS 简化 `nth-child` 样式的生成</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-10-15T03:10:00+08:00" itemprop="datePublished">Oct 15, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="利用-sass-简化-nth-child-样式的生成">利用 SASS 简化 <code class="language-plaintext highlighter-rouge">nth-child</code> 样式的生成</h1>

<p>考察如下的 HTML 片段，通过 CSS 的 <code class="language-plaintext highlighter-rouge">nth-child()</code> 伪选择器实现列表的颜色循环，比如每三个一次循环。</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>1<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>2<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>3<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>4<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>5<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>6<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div></div>

<p>很容易地，我们能得出如下样式代码：</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">ul</span> <span class="p">{</span>
  <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3n</span> <span class="o">+</span> <span class="nt">1</span><span class="o">)</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">indigo</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3n</span> <span class="o">+</span> <span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3n</span> <span class="o">+</span> <span class="nt">3</span><span class="o">)</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>以上，只三种颜色循环，简单情况下可这样处理。但样式多起来之后，上面代码显得很臃肿且不易维护。</p>

<p>既然是使用 SASS，很容易想到可通过编写循环语句来将其简化。</p>

<p>循环过程就是遍历一个预设的颜色列表，为每一个颜色生成相应的样式。</p>

<h2 id="list--map">List &amp; Map</h2>

<p>首先需要定义一个对象来保存预设的颜色列表，SASS 中的 <a href="https://sass-lang.com/documentation/values/lists">Lists</a> 可满足条件。</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">;</span>
</code></pre></div></div>

<p>使用上面的 list:</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">;</span>

<span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
  <span class="nc">.color-</span><span class="si">#{</span><span class="nv">$color</span><span class="si">}</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>编译后输出：</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.color-indigo</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">indigo</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.color-red</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.color-green</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>当然，也可以定义 <a href="https://sass-lang.com/documentation/values/maps">Map</a> 类型，为每种颜色指定名字，这样使用的时候比较语义：</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="p">(</span>
  <span class="s2">"indigo"</span><span class="o">:</span> <span class="no">indigo</span><span class="o">,</span>
  <span class="s2">"red"</span><span class="o">:</span> <span class="no">red</span><span class="o">,</span>
  <span class="s2">"green"</span><span class="o">:</span> <span class="no">green</span>
<span class="p">);</span>

<span class="k">@each</span> <span class="nv">$name</span><span class="o">,</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
  <span class="nc">.color-</span><span class="si">#{</span><span class="nv">$name</span><span class="si">}</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="索引">索引</h2>

<p>列表对象及其遍历如上，现在还需要在遍历过程中获得一个 index 索引值，用于生成 <code class="language-plaintext highlighter-rouge">3*n+index</code>。</p>

<p>通过 <code class="language-plaintext highlighter-rouge">index()</code> 函数可以达到目的：</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="p">(</span><span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">);</span>

<span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
  <span class="nv">$index</span><span class="p">:</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$colors</span><span class="o">,</span> <span class="nv">$color</span><span class="p">);</span>
  <span class="nc">.color-</span><span class="si">#{</span><span class="nv">$index</span><span class="si">}</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>编译后输出：</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.color-1</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">indigo</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.color-2</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.color-3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="生成-nth-child-样式">生成 <code class="language-plaintext highlighter-rouge">nth-child</code> 样式</h2>

<p>结合上面所有，可以得出生成 <code class="language-plaintext highlighter-rouge">nth-child</code> 样式的代码：</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="p">(</span><span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">);</span>

<span class="nt">ul</span> <span class="p">{</span>
  <span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
    <span class="nv">$index</span><span class="p">:</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$colors</span><span class="o">,</span> <span class="nv">$color</span><span class="p">);</span>
    <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="nt">3n</span> <span class="o">+</span> <span class="si">#{</span><span class="nv">$index</span><span class="si">}</span><span class="o">)</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>编译后输出：</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span> <span class="o">+</span> <span class="err">1</span><span class="o">)</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">indigo</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span> <span class="o">+</span> <span class="err">2</span><span class="o">)</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span> <span class="o">+</span> <span class="err">3</span><span class="o">)</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>注意到 <code class="language-plaintext highlighter-rouge">nth-child(3n + #{$index})</code> 中的 <code class="language-plaintext highlighter-rouge">3</code> 是硬编码。既然我们的颜色是在一个数组中，所以我们是知道总个数的，也就能替换掉这里硬编码的写法。</p>

<p>通过 <code class="language-plaintext highlighter-rouge">length()</code> 函数可获得 list 的长度。改进后的代码如下：</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="p">(</span><span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">);</span>

<span class="nt">ul</span> <span class="p">{</span>
  <span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
    <span class="nv">$index</span><span class="p">:</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$colors</span><span class="o">,</span> <span class="nv">$color</span><span class="p">);</span>
    <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="si">#{</span><span class="nf">length</span><span class="p">(</span><span class="nv">$colors</span><span class="p">)</span><span class="si">}</span><span class="nt">n</span> <span class="o">+</span> <span class="si">#{</span><span class="nv">$index</span><span class="si">}</span><span class="o">)</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>这样，如果后续有颜色增加，或顺序的调整，我们只需要更新 <code class="language-plaintext highlighter-rouge">$colors</code> 变量的值即可。</p>

<h2 id="mixin">@mixin</h2>

<p>进一步，我们可以将上面遍历生成 <code class="language-plaintext highlighter-rouge">nth-child</code> 的代码抽取成 mixin，这样可以被其他地方使用。</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="p">(</span><span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">);</span>

<span class="k">@mixin</span> <span class="nf">nth-color</span> <span class="p">{</span>
  <span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
    <span class="nv">$index</span><span class="p">:</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$colors</span><span class="o">,</span> <span class="nv">$color</span><span class="p">);</span>
    <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="si">#{</span><span class="nf">length</span><span class="p">(</span><span class="nv">$colors</span><span class="p">)</span><span class="si">}</span><span class="nt">n</span> <span class="o">+</span> <span class="si">#{</span><span class="nv">$index</span><span class="si">}</span><span class="o">)</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nt">ul</span> <span class="p">{</span>
  <span class="k">@include</span> <span class="nd">nth-color</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="mixin-的优化">mixin 的优化</h2>

<p>但像上面这样还不能达到完全公用，因为 mixin 中使用了 <code class="language-plaintext highlighter-rouge">li</code> 选择器，不是所有需要 <code class="language-plaintext highlighter-rouge">nth-child</code> 样式的地方，都使用的 <code class="language-plaintext highlighter-rouge">li</code> 元素，所以此处需要进行优化，使得 mixin 中的这部分内容灵活一点，以适用不同的使用环境。</p>

<p>首先，使用 <code class="language-plaintext highlighter-rouge">&amp;</code> 父选择器便可快速解决，这样生成的样式便由包含这个 mixin 的选择器决定了。</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="p">(</span><span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">);</span>

<span class="k">@mixin</span> <span class="nf">nth-color</span> <span class="p">{</span>
  <span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
    <span class="nv">$index</span><span class="p">:</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$colors</span><span class="o">,</span> <span class="nv">$color</span><span class="p">);</span>
    <span class="k">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="si">#{</span><span class="nf">length</span><span class="p">(</span><span class="nv">$colors</span><span class="p">)</span><span class="si">}</span><span class="nt">n</span> <span class="o">+</span> <span class="si">#{</span><span class="nv">$index</span><span class="si">}</span><span class="o">)</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nt">ul</span> <span class="p">{</span>
  <span class="nt">li</span> <span class="p">{</span>
    <span class="k">@include</span> <span class="nd">nth-color</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>诚然，这样修改过后，确实可以将该 mixin 使用于多个地方了。</p>

<p>但考虑这么一种情况，因为上面列表比较简单，更加常见的情况是，列表中是另外复杂的元素，而不是单纯的一个元素，比如像下面这样：</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">className=</span><span class="s">"item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3&gt;</span>title<span class="nt">&lt;/h3&gt;</span>
      <span class="nt">&lt;div&gt;</span>desc goes here...<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">className=</span><span class="s">"item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3&gt;</span>title<span class="nt">&lt;/h3&gt;</span>
      <span class="nt">&lt;div&gt;</span>desc goes here...<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">className=</span><span class="s">"item"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h3&gt;</span>title<span class="nt">&lt;/h3&gt;</span>
      <span class="nt">&lt;div&gt;</span>desc goes here...<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</code></pre></div></div>

<p>现在想针对列表元素中的 <code class="language-plaintext highlighter-rouge">h3</code> 进行颜色的设置，即 <code class="language-plaintext highlighter-rouge">nth-child</code> 中设置的 <code class="language-plaintext highlighter-rouge">color</code> 只针对 <code class="language-plaintext highlighter-rouge">h3</code> 而不是整个 <code class="language-plaintext highlighter-rouge">li</code> 元素。</p>

<p>结合前面的优化，似乎可以这样写：</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$colors:</span> (indigo, red, green);

@mixin nth-color {
  @each $color in $colors {
    $index: index($colors, $color);
<span class="gd">-    &amp;:nth-child(#{length($colors)}n + #{$index}) {
</span><span class="gi">+    &amp;:nth-child(#{length($colors)}n + #{$index}) h3{
</span>      color: $color;
    }
  }
<span class="err">}</span>

<span class="p">ul {
</span>  li {
    @include nth-color;
  }
<span class="err">}</span>
</code></pre></div></div>

<p>编译后的结果：</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">1</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">indigo</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">2</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">3</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>从结果来看，达到了目标。但又在 <code class="language-plaintext highlighter-rouge">nth-color</code> 这个 mixin 中引入了 <code class="language-plaintext highlighter-rouge">h3</code>，使其变得不再通用，问题又回到了之前。</p>

<p>所以 <code class="language-plaintext highlighter-rouge">&amp;</code> 只解决了 <code class="language-plaintext highlighter-rouge">nth-child</code> 父级嵌套的问题，对于 <code class="language-plaintext highlighter-rouge">nth-child</code> 后面还需要自定义选择器的情况，就需要用别的方式进一步优化。</p>

<h2 id="给-mixin-传参">给 <code class="language-plaintext highlighter-rouge">@mixin</code> 传参</h2>

<p>mixin 是可以接收参数的，通过外部传递选择器进来，可以达到将 <code class="language-plaintext highlighter-rouge">h3</code> 从 mixin 从剥离的目的。</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@mixin</span> <span class="nf">nth-color</span><span class="p">(</span><span class="nv">$child</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
    <span class="nv">$index</span><span class="p">:</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$colors</span><span class="o">,</span> <span class="nv">$color</span><span class="p">);</span>
    <span class="k">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="si">#{</span><span class="nf">length</span><span class="p">(</span><span class="nv">$colors</span><span class="p">)</span><span class="si">}</span><span class="nt">n</span> <span class="o">+</span> <span class="si">#{</span><span class="nv">$index</span><span class="si">}</span><span class="o">)</span> <span class="si">#{</span><span class="nv">$child</span><span class="si">}</span><span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nt">ul</span> <span class="p">{</span>
  <span class="nt">li</span> <span class="p">{</span>
    <span class="k">@include</span> <span class="nd">nth-color</span><span class="p">(</span><span class="s2">"h3"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="从-mixin-将参数传递到外面">从 <code class="language-plaintext highlighter-rouge">@mixin</code> 将参数传递到外面</h2>

<p>最后，<code class="language-plaintext highlighter-rouge">nth-color</code> 这个 mixin 还有一处不够灵活的地方，便是其样式内容。</p>

<p>现在在其中写死了只有一个 <code class="language-plaintext highlighter-rouge">color: $color;</code> 属性，也就是说，使用该 mixin 的地方只能用它来设置元素的字色。如果 mixin 能够将颜色传递出来，这样外部使用的时候就可以用到其他属性上，更加的灵活了。</p>

<p>SASS 确实也提供了这么种机制，即 mixin 能够身外传递参数，借助 <a href="https://sass-lang.com/documentation/at-rules/mixin#passing-arguments-to-content-blocks"><code class="language-plaintext highlighter-rouge">@content</code></a> 指令。</p>

<p><code class="language-plaintext highlighter-rouge">@content</code> 指令指代调用 mixin 时书写的模式内容部分。如下的代码直观展示了其功能：</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">@mixin</span> nth-color($child) {
  @each $color in $colors {
    $index: index($colors, $color);
    &amp;:nth-child(#{length($colors)}n + #{$index}) #{$child}{
      color: $color;
<span class="gi">+      @content;
</span>    }
  }
<span class="err">}</span>

<span class="p">ul {
</span>  li {
<span class="gd">-    @include nth-color("h3")
</span><span class="gi">+    @include nth-color("h3"){
+      border:1px solid orange;
+    };
</span>  }
<span class="err">}</span>
</code></pre></div></div>

<p>编译后内容为：</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">1</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">indigo</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">orange</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">2</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">orange</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">3</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">orange</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>可以看到，外部书写的 <code class="language-plaintext highlighter-rouge">border: 1px solid orange;</code> 通过 <code class="language-plaintext highlighter-rouge">@content</code> 指代而放进了每个 <code class="language-plaintext highlighter-rouge">nth-child</code> 样式中。只是这个 <code class="language-plaintext highlighter-rouge">border</code> 的颜色现在还是写死的 <code class="language-plaintext highlighter-rouge">orange</code>，现在来将其设置成跟随相应的字色，即跟着 <code class="language-plaintext highlighter-rouge">color</code> 属性走。</p>

<p>当我们使用 <code class="language-plaintext highlighter-rouge">@content(&lt;arguments...&gt;)</code> 形式的 <code class="language-plaintext highlighter-rouge">@content</code> 时，可以传递一些参数，外部调用该 mixin 时需要使用如下形式来获取传递的参数：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@include &lt;name&gt; using (&lt;arguments...&gt;)
</code></pre></div></div>

<p><strong>NOTE：</strong>：这里的 <a href="https://sass-lang.com/documentation/at-rules/mixin#passing-arguments-to-content-blocks"><code class="language-plaintext highlighter-rouge">using</code></a> 语法只部分 SASS 实现（Dart Sass since 1.15.0, LibSass, Ruby Sass）中有支持，<a href="https://github.com/sass/node-sass">node-sass</a> 还没有。</p>

<h2 id="最终的-mixin">最终的 mixin</h2>

<p>所以，最终版的代码为：</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$colors</span><span class="p">:</span> <span class="p">(</span><span class="no">indigo</span><span class="o">,</span> <span class="no">red</span><span class="o">,</span> <span class="no">green</span><span class="p">);</span>

<span class="k">@mixin</span> <span class="nf">nth-color</span><span class="p">(</span><span class="nv">$child</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">@each</span> <span class="nv">$color</span> <span class="n">in</span> <span class="nv">$colors</span> <span class="p">{</span>
    <span class="nv">$index</span><span class="p">:</span> <span class="nf">index</span><span class="p">(</span><span class="nv">$colors</span><span class="o">,</span> <span class="nv">$color</span><span class="p">);</span>
    <span class="k">&amp;</span><span class="nd">:nth-child</span><span class="o">(</span><span class="si">#{</span><span class="nf">length</span><span class="p">(</span><span class="nv">$colors</span><span class="p">)</span><span class="si">}</span><span class="nt">n</span> <span class="o">+</span> <span class="si">#{</span><span class="nv">$index</span><span class="si">}</span><span class="o">)</span> <span class="si">#{</span><span class="nv">$child</span><span class="si">}</span> <span class="p">{</span>
      <span class="nl">color</span><span class="p">:</span> <span class="nv">$color</span><span class="p">;</span>
      <span class="k">@content</span> <span class="o">(</span><span class="err">$</span><span class="nt">color</span><span class="o">)</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nt">ul</span> <span class="p">{</span>
  <span class="nt">li</span> <span class="p">{</span>
    <span class="k">@include</span> <span class="nd">nth-color</span><span class="p">(</span><span class="s2">"h3"</span><span class="p">)</span> <span class="nf">using</span><span class="p">(</span><span class="nv">$color</span><span class="p">)</span> <span class="p">{</span>
      <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="si">#{</span><span class="nv">$color</span><span class="si">}</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>编译后得到的 CSS：</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">1</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">indigo</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">indigo</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">2</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">red</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span> <span class="nt">li</span><span class="nd">:nth-child</span><span class="o">(</span><span class="err">3</span><span class="nt">n</span><span class="o">+</span><span class="err">3</span><span class="o">)</span> <span class="nt">h3</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">green</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="no">green</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="总结">总结</h2>

<p>通过将生成 <code class="language-plaintext highlighter-rouge">nth-child</code> 样式的规则自动化的过程中，顺带使用了 SASS 中另外一些特性，</p>

<ul>
  <li>定义和使用数组及对象</li>
  <li>数组及对象的遍历</li>
  <li>遍历过程中索引的获取</li>
  <li><code class="language-plaintext highlighter-rouge">@mixin</code> 的使用，参数的传递</li>
  <li><code class="language-plaintext highlighter-rouge">@mixin</code> 中 <code class="language-plaintext highlighter-rouge">@content</code> 的使用</li>
  <li><code class="language-plaintext highlighter-rouge">@mixin</code> 中向外传递参数</li>
</ul>

<h2 id="相关资源">相关资源</h2>

<ul>
  <li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:nth-child">:nth-child()</a></li>
  <li><a href="https://sass-lang.com/documentation/values/lists">SASS documentation - Lists</a></li>
  <li><a href="https://sass-lang.com/documentation/values/maps">SASS documentation - Maps</a></li>
  <li><a href="https://sass-lang.com/documentation/at-rules/mixin#passing-arguments-to-content-blocks"><code class="language-plaintext highlighter-rouge">@content</code></a></li>
</ul>


  </div><a class="u-url" href="/2019/10/15/%E5%88%A9%E7%94%A8-SASS-%E7%AE%80%E5%8C%96-nth-child-%E6%A0%B7%E5%BC%8F%E7%9A%84%E7%94%9F%E6%88%90.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">牛さんの部落格</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">牛さんの部落格</li><li><a class="u-email" href="mailto:liuwayong@gmail.com">liuwayong@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>notes about the coding life</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
