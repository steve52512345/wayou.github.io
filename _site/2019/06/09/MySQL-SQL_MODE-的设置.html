<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>MySQL SQL_MODE 的设置 | 牛さんの部落格</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="MySQL SQL_MODE 的设置" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SQL_MODE 的设置 查看当前的 SQL_MODE SELECT @@sql_mode SELECT @@sql_mode 的执行结果 ```sh mysql&gt; SELECT @@sql_mode; +-----------------------------------------------------------------------------------------------------------------------+ | @@sql_mode | +-----------------------------------------------------------------------------------------------------------------------+ | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | +-----------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) ``` 设置 SQL_MODE 设置 SQL_MODE 是通过 SET 关键词进行的，其他参数值也可通过该关键词进行修改。可通过 SHOW VARIABLES 查看到所有可用配置项。 设置系统变量时，可指定所设置的作用域，也可通过 @@ 前缀来获取变量，甚至也可以没有任何前缀，以下写法都是合法的： SET SESSION sql_mode = &#39;TRADITIONAL&#39;; SET LOCAL sql_mode = &#39;TRADITIONAL&#39;; SET @@SESSION.sql_mode = &#39;TRADITIONAL&#39;; SET @@LOCAL.sql_mode = &#39;TRADITIONAL&#39;; SET @@sql_mode = &#39;TRADITIONAL&#39;; SET sql_mode = &#39;TRADITIONAL&#39;; 可用的 SQL 模式可在官方文档中查询到 5.1.10 Server SQL Modes。 系统变量的作用域 There are two scopes in which system variables exist. Global variables affect the overall operation of the server. Session variables affect its operation for individual client connections. A given system variable can have both a global and a session value. --5.1.9 Using System Variables 系统的这些配置项有其作用项，是分开进行管理的。 其中， GLOBAL 类型会对每次连接生效。 SESSION 类型只对当前连接生效，LOCAL 关键词等效。 两者皆为运行时变量，可随时修改。 PERSIST 类型不影响运行时，会将设置结果写入 mysqld-auto.cnf 这个 MySQL 配置文件。 所以，设置时可通过在 SET 后加相应作用域的修饰词，像这样 SET GLOBAL sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; 也可以通过 @@ 加上作用域进行变量访问的方式： SET @@GLOBAL.sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; 两者是等效的。 作用域缺省情况下为 SESSION 类型，即只对当前连接生效。 SET @@sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; MySQL 中的配置文件 下面表格来自官方文档 Table 4.2 Option Files Read on Unix and Unix-Like Systems 部分。 文件 用途 /etc/my.cnf 全局配置项 /etc/mysql/my.cnf 全局配置项 SYSCONFDIR/my.cnf 全局配置项 $MYSQL_HOME/my.cnf 服务器相关配置项，有于服务端 defaults-extra-file 如果存在该文件的话，通过--defaults-extra-file 参数启用程序时会读取该配置项 ~/.my.cnf 用户配置项 ~/.mylogin.cnf 用户登录路径相关，用于客户端 DATADIR/mysqld-auto.cnf SET PERSIST 或 SE PERSIST_ONLY 设置的系统参数会保存到该文件 相交资源 5.1.10 Server SQL Modes setting global sql_mode in mysql 5.1.9 Using System Variables 4.2.2.2 Using Option Files 13.7.4.1 SET Syntax for Variable Assignment" />
<meta property="og:description" content="SQL_MODE 的设置 查看当前的 SQL_MODE SELECT @@sql_mode SELECT @@sql_mode 的执行结果 ```sh mysql&gt; SELECT @@sql_mode; +-----------------------------------------------------------------------------------------------------------------------+ | @@sql_mode | +-----------------------------------------------------------------------------------------------------------------------+ | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | +-----------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) ``` 设置 SQL_MODE 设置 SQL_MODE 是通过 SET 关键词进行的，其他参数值也可通过该关键词进行修改。可通过 SHOW VARIABLES 查看到所有可用配置项。 设置系统变量时，可指定所设置的作用域，也可通过 @@ 前缀来获取变量，甚至也可以没有任何前缀，以下写法都是合法的： SET SESSION sql_mode = &#39;TRADITIONAL&#39;; SET LOCAL sql_mode = &#39;TRADITIONAL&#39;; SET @@SESSION.sql_mode = &#39;TRADITIONAL&#39;; SET @@LOCAL.sql_mode = &#39;TRADITIONAL&#39;; SET @@sql_mode = &#39;TRADITIONAL&#39;; SET sql_mode = &#39;TRADITIONAL&#39;; 可用的 SQL 模式可在官方文档中查询到 5.1.10 Server SQL Modes。 系统变量的作用域 There are two scopes in which system variables exist. Global variables affect the overall operation of the server. Session variables affect its operation for individual client connections. A given system variable can have both a global and a session value. --5.1.9 Using System Variables 系统的这些配置项有其作用项，是分开进行管理的。 其中， GLOBAL 类型会对每次连接生效。 SESSION 类型只对当前连接生效，LOCAL 关键词等效。 两者皆为运行时变量，可随时修改。 PERSIST 类型不影响运行时，会将设置结果写入 mysqld-auto.cnf 这个 MySQL 配置文件。 所以，设置时可通过在 SET 后加相应作用域的修饰词，像这样 SET GLOBAL sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; 也可以通过 @@ 加上作用域进行变量访问的方式： SET @@GLOBAL.sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; 两者是等效的。 作用域缺省情况下为 SESSION 类型，即只对当前连接生效。 SET @@sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; MySQL 中的配置文件 下面表格来自官方文档 Table 4.2 Option Files Read on Unix and Unix-Like Systems 部分。 文件 用途 /etc/my.cnf 全局配置项 /etc/mysql/my.cnf 全局配置项 SYSCONFDIR/my.cnf 全局配置项 $MYSQL_HOME/my.cnf 服务器相关配置项，有于服务端 defaults-extra-file 如果存在该文件的话，通过--defaults-extra-file 参数启用程序时会读取该配置项 ~/.my.cnf 用户配置项 ~/.mylogin.cnf 用户登录路径相关，用于客户端 DATADIR/mysqld-auto.cnf SET PERSIST 或 SE PERSIST_ONLY 设置的系统参数会保存到该文件 相交资源 5.1.10 Server SQL Modes setting global sql_mode in mysql 5.1.9 Using System Variables 4.2.2.2 Using Option Files 13.7.4.1 SET Syntax for Variable Assignment" />
<link rel="canonical" href="http://localhost:4000/2019/06/09/MySQL-SQL_MODE-%E7%9A%84%E8%AE%BE%E7%BD%AE.html" />
<meta property="og:url" content="http://localhost:4000/2019/06/09/MySQL-SQL_MODE-%E7%9A%84%E8%AE%BE%E7%BD%AE.html" />
<meta property="og:site_name" content="牛さんの部落格" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-06-09T12:06:00+08:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/2019/06/09/MySQL-SQL_MODE-%E7%9A%84%E8%AE%BE%E7%BD%AE.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2019/06/09/MySQL-SQL_MODE-%E7%9A%84%E8%AE%BE%E7%BD%AE.html"},"description":"SQL_MODE 的设置 查看当前的 SQL_MODE SELECT @@sql_mode SELECT @@sql_mode 的执行结果 ```sh mysql&gt; SELECT @@sql_mode; +-----------------------------------------------------------------------------------------------------------------------+ | @@sql_mode | +-----------------------------------------------------------------------------------------------------------------------+ | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | +-----------------------------------------------------------------------------------------------------------------------+ 1 row in set (0.00 sec) ``` 设置 SQL_MODE 设置 SQL_MODE 是通过 SET 关键词进行的，其他参数值也可通过该关键词进行修改。可通过 SHOW VARIABLES 查看到所有可用配置项。 设置系统变量时，可指定所设置的作用域，也可通过 @@ 前缀来获取变量，甚至也可以没有任何前缀，以下写法都是合法的： SET SESSION sql_mode = &#39;TRADITIONAL&#39;; SET LOCAL sql_mode = &#39;TRADITIONAL&#39;; SET @@SESSION.sql_mode = &#39;TRADITIONAL&#39;; SET @@LOCAL.sql_mode = &#39;TRADITIONAL&#39;; SET @@sql_mode = &#39;TRADITIONAL&#39;; SET sql_mode = &#39;TRADITIONAL&#39;; 可用的 SQL 模式可在官方文档中查询到 5.1.10 Server SQL Modes。 系统变量的作用域 There are two scopes in which system variables exist. Global variables affect the overall operation of the server. Session variables affect its operation for individual client connections. A given system variable can have both a global and a session value. --5.1.9 Using System Variables 系统的这些配置项有其作用项，是分开进行管理的。 其中， GLOBAL 类型会对每次连接生效。 SESSION 类型只对当前连接生效，LOCAL 关键词等效。 两者皆为运行时变量，可随时修改。 PERSIST 类型不影响运行时，会将设置结果写入 mysqld-auto.cnf 这个 MySQL 配置文件。 所以，设置时可通过在 SET 后加相应作用域的修饰词，像这样 SET GLOBAL sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; 也可以通过 @@ 加上作用域进行变量访问的方式： SET @@GLOBAL.sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; 两者是等效的。 作用域缺省情况下为 SESSION 类型，即只对当前连接生效。 SET @@sql_mode = &#39;NO_ENGINE_SUBSTITUTION&#39;; MySQL 中的配置文件 下面表格来自官方文档 Table 4.2 Option Files Read on Unix and Unix-Like Systems 部分。 文件 用途 /etc/my.cnf 全局配置项 /etc/mysql/my.cnf 全局配置项 SYSCONFDIR/my.cnf 全局配置项 $MYSQL_HOME/my.cnf 服务器相关配置项，有于服务端 defaults-extra-file 如果存在该文件的话，通过--defaults-extra-file 参数启用程序时会读取该配置项 ~/.my.cnf 用户配置项 ~/.mylogin.cnf 用户登录路径相关，用于客户端 DATADIR/mysqld-auto.cnf SET PERSIST 或 SE PERSIST_ONLY 设置的系统参数会保存到该文件 相交资源 5.1.10 Server SQL Modes setting global sql_mode in mysql 5.1.9 Using System Variables 4.2.2.2 Using Option Files 13.7.4.1 SET Syntax for Variable Assignment","@type":"BlogPosting","headline":"MySQL SQL_MODE 的设置","dateModified":"2019-06-09T12:06:00+08:00","datePublished":"2019-06-09T12:06:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="牛さんの部落格" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">牛さんの部落格</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">MySQL SQL_MODE 的设置</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-06-09T12:06:00+08:00" itemprop="datePublished">Jun 9, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="sql_mode-的设置">SQL_MODE 的设置</h1>

<h2 id="查看当前的-sql_mode">查看当前的 SQL_MODE</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">@@</span><span class="n">sql_mode</span>
</code></pre></div></div>

<details>
<summary>
SELECT @@sql_mode 的执行结果
</summary>

```sh
mysql&gt; SELECT @@sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@sql_mode                                                                                                            |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

</details>

<h2 id="设置-sql_mode">设置 SQL_MODE</h2>

<p>设置 SQL_MODE 是通过 <code class="language-plaintext highlighter-rouge">SET</code> 关键词进行的，其他参数值也可通过该关键词进行修改。可通过 <code class="language-plaintext highlighter-rouge">SHOW VARIABLES</code> 查看到所有可用配置项。</p>

<p>设置系统变量时，可指定所设置的作用域，也可通过 <code class="language-plaintext highlighter-rouge">@@</code> 前缀来获取变量，甚至也可以没有任何前缀，以下写法都是合法的：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SET</span> <span class="k">SESSION</span> <span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'TRADITIONAL'</span><span class="p">;</span>
<span class="k">SET</span> <span class="k">LOCAL</span> <span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'TRADITIONAL'</span><span class="p">;</span>
<span class="k">SET</span> <span class="o">@@</span><span class="k">SESSION</span><span class="p">.</span><span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'TRADITIONAL'</span><span class="p">;</span>
<span class="k">SET</span> <span class="o">@@</span><span class="k">LOCAL</span><span class="p">.</span><span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'TRADITIONAL'</span><span class="p">;</span>
<span class="k">SET</span> <span class="o">@@</span><span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'TRADITIONAL'</span><span class="p">;</span>
<span class="k">SET</span> <span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'TRADITIONAL'</span><span class="p">;</span>
</code></pre></div></div>

<p>可用的 SQL 模式可在官方文档中查询到 <a href="https://dev.mysql.com/doc/refman/5.6/en/sql-mode.html">5.1.10 Server SQL Modes</a>。</p>

<h3 id="系统变量的作用域">系统变量的作用域</h3>

<blockquote>
  <p>There are two scopes in which system variables exist. Global variables affect the overall operation of the server. Session variables affect its operation for individual client connections. A given system variable can have both a global and a session value.</p>

  <p><em>--<a href="https://dev.mysql.com/doc/refman/8.0/en/using-system-variables.html">5.1.9 Using System Variables</a></em></p>
</blockquote>

<p>系统的这些配置项有其作用项，是分开进行管理的。</p>

<p>其中，</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GLOBAL</code> 类型会对每次连接生效。</li>
  <li><code class="language-plaintext highlighter-rouge">SESSION</code> 类型只对当前连接生效，<code class="language-plaintext highlighter-rouge">LOCAL</code> 关键词等效。</li>
</ul>

<p>两者皆为运行时变量，可随时修改。</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">PERSIST</code> 类型不影响运行时，会将设置结果写入 <code class="language-plaintext highlighter-rouge">mysqld-auto.cnf</code> 这个 MySQL 配置文件。</li>
</ul>

<p>所以，设置时可通过在 <code class="language-plaintext highlighter-rouge">SET</code> 后加相应作用域的修饰词，像这样</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SET</span> <span class="k">GLOBAL</span> <span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'NO_ENGINE_SUBSTITUTION'</span><span class="p">;</span>
</code></pre></div></div>

<p>也可以通过 <code class="language-plaintext highlighter-rouge">@@</code> 加上作用域进行变量访问的方式：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SET</span> <span class="o">@@</span><span class="k">GLOBAL</span><span class="p">.</span><span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'NO_ENGINE_SUBSTITUTION'</span><span class="p">;</span>
</code></pre></div></div>

<p>两者是等效的。</p>

<p>作用域缺省情况下为 <code class="language-plaintext highlighter-rouge">SESSION</code> 类型，即只对当前连接生效。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SET</span> <span class="o">@@</span><span class="n">sql_mode</span> <span class="o">=</span> <span class="s1">'NO_ENGINE_SUBSTITUTION'</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="mysql-中的配置文件">MySQL 中的配置文件</h3>

<p>下面表格来自官方文档 <a href="https://dev.mysql.com/doc/refman/8.0/en/option-files.html">Table 4.2 Option Files Read on Unix and Unix-Like Systems</a> 部分。</p>

<table>
  <thead>
    <tr>
      <th>文件</th>
      <th>用途</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>/etc/my.cnf</td>
      <td>全局配置项</td>
    </tr>
    <tr>
      <td>/etc/mysql/my.cnf</td>
      <td>全局配置项</td>
    </tr>
    <tr>
      <td>SYSCONFDIR/my.cnf</td>
      <td>全局配置项</td>
    </tr>
    <tr>
      <td>$MYSQL_HOME/my.cnf</td>
      <td>服务器相关配置项，有于服务端</td>
    </tr>
    <tr>
      <td>defaults-extra-file</td>
      <td>如果存在该文件的话，通过<a href="https://dev.mysql.com/doc/refman/8.0/en/option-file-options.html#option_general_defaults-extra-file"><code class="language-plaintext highlighter-rouge">--defaults-extra-file</code></a> 参数启用程序时会读取该配置项</td>
    </tr>
    <tr>
      <td>~/.my.cnf</td>
      <td>用户配置项</td>
    </tr>
    <tr>
      <td>~/.mylogin.cnf</td>
      <td>用户登录路径相关，用于客户端</td>
    </tr>
    <tr>
      <td>DATADIR/mysqld-auto.cnf</td>
      <td><a href="https://dev.mysql.com/doc/refman/8.0/en/set-variable.html"><code class="language-plaintext highlighter-rouge">SET PERSIST</code></a> 或 <a href="https://dev.mysql.com/doc/refman/8.0/en/set-variable.html"><code class="language-plaintext highlighter-rouge">SE PERSIST_ONLY</code></a> 设置的系统参数会保存到该文件</td>
    </tr>
  </tbody>
</table>

<h2 id="相交资源">相交资源</h2>

<ul>
  <li><a href="https://dev.mysql.com/doc/refman/5.7/en/sql-mode.html">5.1.10 Server SQL Modes</a></li>
  <li><a href="https://stackoverflow.com/questions/2317650/setting-global-sql-mode-in-mysql">setting global sql_mode in mysql</a></li>
  <li><a href="https://dev.mysql.com/doc/refman/8.0/en/using-system-variables.html">5.1.9 Using System Variables</a></li>
  <li><a href="https://dev.mysql.com/doc/refman/8.0/en/option-files.html">4.2.2.2 Using Option Files</a></li>
  <li><a href="https://dev.mysql.com/doc/refman/5.7/en/set-variable.html">13.7.4.1 SET Syntax for Variable Assignment</a></li>
</ul>


  </div><a class="u-url" href="/2019/06/09/MySQL-SQL_MODE-%E7%9A%84%E8%AE%BE%E7%BD%AE.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">牛さんの部落格</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">牛さんの部落格</li><li><a class="u-email" href="mailto:liuwayong@gmail.com">liuwayong@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>notes about the coding life</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
